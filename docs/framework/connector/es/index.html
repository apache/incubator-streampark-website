<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-framework/connector/es" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Elasticsearch Connector | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org/docs/framework/connector/es"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Elasticsearch Connector | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="Elasticsearch is a distributed, RESTful style search and data analysis"><meta data-rh="true" property="og:description" content="Elasticsearch is a distributed, RESTful style search and data analysis"><link data-rh="true" rel="icon" href="/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org/docs/framework/connector/es"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/connector/es" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/zh-CN/docs/framework/connector/es" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/connector/es" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/assets/css/styles.2815dd1e.css">
<script src="/assets/js/runtime~main.788200c2.js" defer="defer"></script>
<script src="/assets/js/main.237a4499.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_BCtO" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--light_uT2j"><img src="/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--dark_ENih"></div><b class="navbar__title text--truncate">StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/get-started/intro">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of conduct</a></li><li><a class="dropdown__link" href="/community/contribution_guide/mailing_lists">Join the mailing lists</a></li><li><a class="dropdown__link" href="/community/contribution_guide/become_committer">Become A Committer</a></li><li><a class="dropdown__link" href="/community/contribution_guide/become_pmc_member">Become A PMC member</a></li><li><a class="dropdown__link" href="/community/contribution_guide/new_committer_process">New Committer Process</a></li><li><a class="dropdown__link" href="/community/contribution_guide/new_pmc_ember_process">New PMC Member Process</a></li><li><a class="dropdown__link" href="/community/submit_guide/document">Documentation Notice</a></li><li><a class="dropdown__link" href="/community/submit_guide/submit_code">Submit Code</a></li><li><a class="dropdown__link" href="/community/submit_guide/code_style_and_quality_guide">Code style and quality guide</a></li><li><a class="dropdown__link" href="/community/submit_guide/documentation_style_guide">Documentation style guide</a></li><li><a class="dropdown__link" href="/community/release/how_to_release_version_2.1.x">How to release version 2.1.x</a></li><li><a class="dropdown__link" href="/community/release/how_to_verify_release">How to Verify Release</a></li></ul></div><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/user">Users</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><a href="https://github.com/apache/incubator-streampark" target="_blank" class="githubStars_qnS9"><div class="githubStarsContainer_O7dk"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.75C4.27062 1.75 1.25 4.77062 1.25 8.5C1.25 11.4869 3.18219 14.0097 5.86531 14.9041C6.20281 14.9631 6.32937 14.7606 6.32937 14.5834C6.32937 14.4231 6.32094 13.8916 6.32094 13.3263C4.625 13.6384 4.18625 12.9128 4.05125 12.5331C3.97531 12.3391 3.64625 11.74 3.35938 11.5797C3.12312 11.4531 2.78562 11.1409 3.35094 11.1325C3.8825 11.1241 4.26219 11.6219 4.38875 11.8244C4.99625 12.8453 5.96656 12.5584 6.35469 12.3813C6.41375 11.9425 6.59094 11.6472 6.785 11.4784C5.28312 11.3097 3.71375 10.7275 3.71375 8.14563C3.71375 7.41156 3.97531 6.80406 4.40563 6.33156C4.33812 6.16281 4.10187 5.47094 4.47312 4.54281C4.47312 4.54281 5.03844 4.36563 6.32937 5.23469C6.86937 5.08281 7.44313 5.00687 8.01688 5.00687C8.59063 5.00687 9.16438 5.08281 9.70438 5.23469C10.9953 4.35719 11.5606 4.54281 11.5606 4.54281C11.9319 5.47094 11.6956 6.16281 11.6281 6.33156C12.0584 6.80406 12.32 7.40312 12.32 8.14563C12.32 10.7359 10.7422 11.3097 9.24031 11.4784C9.485 11.6894 9.69594 12.0944 9.69594 12.7272C9.69594 13.63 9.6875 14.3556 9.6875 14.5834C9.6875 14.7606 9.81406 14.9716 10.1516 14.9041C12.8178 14.0097 14.75 11.4784 14.75 8.5C14.75 4.77062 11.7294 1.75 8 1.75Z" fill="currentColor"></path></svg><span class="githubText_YlX6">3.9k</span></div></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg></a><ul class="dropdown__menu"><li><a href="/docs/framework/connector/es" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-CN/docs/framework/connector/es" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">简体中文</a></li></ul></div><a class="colorModeButton_yITp undefined"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg></a><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_SuYZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_HgBb searchBarLoadingRing_om0w"><div></div><div></div><div></div><div></div></div></div></div><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_pmYA"><div class="docsWrapper_xNxE"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_yIRJ" type="button"></button><div class="docRoot_vmqG"><aside class="theme-doc-sidebar-container docSidebarContainer_hlm_"><div class="sidebarViewport_c8HV"><div class="sidebar_mhZE"><div class="sidebarSearchContainer_Lwc8"></div><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP" style="padding-top:1.75rem;padding-bottom:250px;overflow-y:auto"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/get-started/intro">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/platform/alert">Platform User Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/framework/dev-model">Development Framework</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/dev-model">Programming Paradigm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/config">Project Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/framework/connector/kafka">Connectors</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/kafka">Apache Kafka Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/jdbc">JDBC Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/clickhouse">ClickHouse Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/doris">Apache Doris Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/framework/connector/es">Elasticsearch Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/hbase">Apache HBase Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/http">HTTP Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/redis">Redis Connector</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/development/development">Development Guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_Ke0w"><div class="container padding-top--md padding-bottom--lg"><div class="row" style="flex-wrap:nowrap"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_FXM1" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_vXXl"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Development Framework</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Connectors</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Elasticsearch Connector</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Elasticsearch Connector</h1></header><p><a href="https://www.elastic.co/cn/elasticsearch/" target="_blank" rel="noopener noreferrer">Elasticsearch</a> is a distributed, RESTful style search and data analysis
engine. <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/connectors/" target="_blank" rel="noopener noreferrer">Apache Flink® officially</a> provides a connector for Elasticsearch, which is used to write data to Elasticsearch, which can provide ** at least once** Semantics.</p>
<p>ElasticsearchSink uses TransportClient (before 6.x) or RestHighLevelClient (starting with 6.x) to communicate with the Elasticsearch cluster. Apache StreamPark further encapsulates Flink-connector-elasticsearch6, shields development details, and simplifies write operations for Elasticsearch6 and above.</p>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">hint</div><p>Because there are conflicts between different versions of Flink Connector Elasticsearch, StreamPark temporarily only
supports write operations of Elasticsearch6 and above. If you wants to using Elasticsearch5, you need to exclude the
flink-connector-elasticsearch6 dependency and introduce the flink-connector-elasticsearch5 dependency to create
org.apache.flink.streaming.connectors.elasticsearch5.ElasticsearchSink instance writes data.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="dependency-of-elastic-writing">Dependency of elastic writing<a href="#dependency-of-elastic-writing" class="hash-link" aria-label="Direct link to Dependency of elastic writing" title="Direct link to Dependency of elastic writing">​</a></h2>
<p>Different Elasticsearch versions rely on the Flink Connector Elasticsearch is not universal, the following information
comes from the <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/docs/connectors/datastream/elasticsearch/" target="_blank" rel="noopener noreferrer">flink-docs-release-1.14 document</a>:</p>
<p>Elasticsearch 5.x Maven dependencies</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-connector-elasticsearch5_2.11</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">1.14.3</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Elasticsearch 6.x Maven dependencies</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-connector-elasticsearch6_2.11</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">1.14.3</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Elasticsearch 7.x ans above Maven dependencies</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-connector-elasticsearch7_2.11</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">1.14.3</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="write-data-to-elasticsearch-based-on-the-official">Write data to Elasticsearch based on the official<a href="#write-data-to-elasticsearch-based-on-the-official" class="hash-link" aria-label="Direct link to Write data to Elasticsearch based on the official" title="Direct link to Write data to Elasticsearch based on the official">​</a></h2>
<p>The following code is taken from the official documentation<a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/connectors/datastream/elasticsearch/#elasticsearch-sink" target="_blank" rel="noopener noreferrer">Elasticsearch based on the official</a></p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">java, Elasticsearch 6.x ans above</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">scala, Elasticsearch 6.x 及以上</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.RuntimeContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.ElasticsearchSinkFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.RequestIndexer;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch6.ElasticsearchSink;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.http.HttpHost;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.index.IndexRequest;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.client.Requests;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.ArrayList;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; input=...;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        List&lt;HttpHost&gt; httpHosts=new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        httpHosts.add(new HttpHost(&quot;127.0.0.1&quot;,9200,&quot;http&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        httpHosts.add(new HttpHost(&quot;10.2.3.1&quot;,9200,&quot;http&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// 使用 ElasticsearchSink.Builder 创建 ElasticsearchSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ElasticsearchSink.Builder&lt;String&gt; esSinkBuilder=new ElasticsearchSink.Builder&lt;&gt;(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        httpHosts,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        new ElasticsearchSinkFunction&lt;String&gt;(){</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public IndexRequest createIndexRequest(String element){</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        Map&lt;String, String&gt; json=new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        json.put(&quot;data&quot;,element);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return Requests.indexRequest()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .index(&quot;my-index&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .type(&quot;my-type&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .source(json);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public void process(String element,RuntimeContext ctx,RequestIndexer indexer){</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        indexer.add(createIndexRequest(element));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Configuration for batch requests; the settings below cause the sink to commit immediately after receiving each element that would otherwise be cached</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        esSinkBuilder.setBulkFlushMaxActions(1);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">A RestClientFactory that provides custom configuration information for internally created REST clients</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        esSinkBuilder.setRestClientFactory(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        restClientBuilder-&gt;{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        restClientBuilder.setDefaultHeaders(...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        restClientBuilder.setMaxRetryTimeoutMillis(...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        restClientBuilder.setPathPrefix(...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        restClientBuilder.setHttpClientConfigCallback(...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Finally, build and add the sink to the job pipeline</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        input.addSink(esSinkBuilder.build());</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.RuntimeContext</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.ElasticsearchSinkFunction</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.RequestIndexer</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch6.ElasticsearchSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.http.HttpHost</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.index.IndexRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.client.Requests</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.ArrayList</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.List</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val input: DataStream[String] =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val httpHosts = new java.util.ArrayList[HttpHost]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">httpHosts.add(new HttpHost(&quot;127.0.0.1&quot;, 9200, &quot;http&quot;))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">httpHosts.add(new HttpHost(&quot;10.2.3.1&quot;, 9200, &quot;http&quot;))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val esSinkBuilder = new ElasticsearchSink.Builder[String](</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  httpHosts,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  new ElasticsearchSinkFunction[String] {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    def process(element: String, ctx: RuntimeContext, indexer: RequestIndexer) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      val json = new java.util.HashMap[String, String]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      json.put(&quot;data&quot;, element)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      val rqst: IndexRequest = Requests.indexRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .index(&quot;my-index&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .`type`(&quot;my-type&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .source(json)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      indexer.add(rqst)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Configuration for batch requests; the settings below cause the sink to commit immediately after receiving each element that would otherwise be cached</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">esSinkBuilder.setBulkFlushMaxActions(1)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// A RestClientFactory that provides custom configuration information for internally created REST clients</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">esSinkBuilder.setRestClientFactory(new RestClientFactory {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def configureRestClientBuilder(restClientBuilder: RestClientBuilder): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    restClientBuilder.setDefaultHeaders(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    restClientBuilder.setMaxRetryTimeoutMillis(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    restClientBuilder.setPathPrefix(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    restClientBuilder.setHttpClientConfigCallback(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">})</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Finally, build and add the sink to the job pipeline</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">input.addSink(esSinkBuilder.build)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>The ElasticsearchSink created above is very inflexible to add parameters. <code>StreamPark</code> follows the concept of convention over configuration and automatic configuration.
Users only need to configure es connection parameters and Flink operating parameters, and StreamPark will automatically assemble source and sink,
which greatly simplifies development logic and improves development efficiency and maintainability.</p>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="using-apache-streampark-writes-to-elasticsearch">Using Apache StreamPark™ writes to Elasticsearch<a href="#using-apache-streampark-writes-to-elasticsearch" class="hash-link" aria-label="Direct link to Using Apache StreamPark™ writes to Elasticsearch" title="Direct link to Using Apache StreamPark™ writes to Elasticsearch">​</a></h2>
<p>Please ensure that operation requests are sent to the Elasticsearch cluster at least once after enabling Flink checkpointing in ESSink.</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="1-配置策略和连接信息">1. 配置策略和连接信息<a href="#1-配置策略和连接信息" class="hash-link" aria-label="Direct link to 1. 配置策略和连接信息" title="Direct link to 1. 配置策略和连接信息">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">#redis sink configure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#  Required parameter, used by multiple nodes host1:port, host2:port,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> localhost</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#  optional parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#  es:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    disableFlushOnCheckpoint: true #默认为false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    auth:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    user:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      password:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    rest:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      max.retry.timeout:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      path.prefix:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      content.type:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    connect:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      request.timeout:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#      timeout:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#    cluster.name: elasticsearch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#  client.transport.sniff:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">#  bulk.flush.:</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="2-写入elasticsearch">2. 写入Elasticsearch<a href="#2-写入elasticsearch" class="hash-link" aria-label="Direct link to 2. 写入Elasticsearch" title="Direct link to 2. 写入Elasticsearch">​</a></h3>
<p>Using StreamPark writes to Elasticsearch</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">scala</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.ESSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.ElasticSearchUtils</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.index.IndexRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.json4s.DefaultFormats</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.json4s.jackson.Serialization</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.Date</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object ConnectorApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  implicit lazy val formats: DefaultFormats.type = org.json4s.DefaultFormats</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val ds = context.fromCollection(List(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(1, 1, 11.3d, 3.1d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(2, 1, 12.3d, 3.2d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(3, 1, 13.3d, 3.3d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(4, 1, 14.3d, 3.4d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(5, 1, 15.3d, 7.5d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(6, 1, 16.3d, 3.6d, new Date()),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      OrderEntity(7, 1, 17.3d, 3.7d, new Date())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // es sink.........</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    //1)Define the writing rules for Index</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    implicit def indexReq(x: OrderEntity): IndexRequest = ElasticSearchUtils.indexRequest(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      &quot;flink_order&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      &quot;_doc&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      s&quot;${x.id}_${x.time.getTime}&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      Serialization.write(x)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    //3)define esSink and sink = data. done</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ESSink().sink6[OrderEntity](ds)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  case class OrderEntity(id: Int, num: Int, price: Double, gmv: Double, time: Date) extends Serializable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>Flink ElasticsearchSinkFunction可以执行多种类型请求，如（DeleteRequest、 UpdateRequest、IndexRequest）,StreamPark也对以上功能进行了支持，对应方法如下：</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStreamSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.scala.DataStream</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.ActionRequestFailureHandler</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch.util.RetryRejectedExecutionFailureHandler</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.elasticsearch6.RestClientFactory</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.delete.DeleteRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.index.IndexRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.elasticsearch.action.update.UpdateRequest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.Properties</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import scala.annotation.meta.param</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class ESSink(@(transient@param) context: StreamingContext,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             property: Properties = new Properties(),</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             parallelism: Int = 0,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             name: String = null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">             uid: String = null) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for ElasticSearch6</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param stream</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param suffix</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param restClientFactory</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param failureHandler</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param f</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @tparam T</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @return</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def sink6[T](stream: DataStream[T],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">               suffix: String = &quot;&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">               restClientFactory: RestClientFactory = null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">               failureHandler: ActionRequestFailureHandler = new RetryRejectedExecutionFailureHandler)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              (implicit f: T =&gt; IndexRequest): DataStreamSink[T] = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    new ES6Sink(context, property, parallelism, name, uid).sink[T](stream, suffix, restClientFactory, failureHandler, f)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def update6[T](stream: DataStream[T],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 suffix: String = &quot;&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 restClientFactory: RestClientFactory = null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 failureHandler: ActionRequestFailureHandler = new RetryRejectedExecutionFailureHandler)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                (f: T =&gt; UpdateRequest): DataStreamSink[T] = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    new ES6Sink(context, property, parallelism, name, uid).sink[T](stream, suffix, restClientFactory, failureHandler, f)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def delete6[T](stream: DataStream[T],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 suffix: String = &quot;&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 restClientFactory: RestClientFactory = null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 failureHandler: ActionRequestFailureHandler = new RetryRejectedExecutionFailureHandler)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                (f: T =&gt; DeleteRequest): DataStreamSink[T] = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    new ES6Sink(context, property, parallelism, name, uid).sink[T](stream, suffix, restClientFactory, failureHandler, f)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">info</div><p>When the Flink checkpoint is enabled, the Flink Elasticsearch Sink guarantees that operation requests are sent to the Elasticsearch cluster at least once.
It does this by waiting for all pending operation requests in the BulkProcessor while checkpointing.
This effectively guarantees that all requests will be successfully acknowledged by Elasticsearch before triggering the checkpoint and proceeding to process records sent to the sink.
If the user wants to disable flushing, they can configure disableFlushOnCheckpoint to true to do so,
which essentially means that the sink will no longer provide any reliable delivery guarantees,
even if checkpointing of the job topology is enabled.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="other-configuration">Other configuration<a href="#other-configuration" class="hash-link" aria-label="Direct link to Other configuration" title="Direct link to Other configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="deal-with-failed-elasticsearch-request">deal with failed Elasticsearch request<a href="#deal-with-failed-elasticsearch-request" class="hash-link" aria-label="Direct link to deal with failed Elasticsearch request" title="Direct link to deal with failed Elasticsearch request">​</a></h3>
<p>An Elasticsearch operation request may fail for a variety of reasons. You can specify the failure handling logic by implementing ActionRequestFailureHandler.
See <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/connectors/datastream/elasticsearch/#elasticsearch-sink" target="_blank" rel="noopener noreferrer">Official Documentation</a> - Handling Failed Elasticsearch Requests</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="configure-the-internal-batch-processor">Configure the internal batch processor<a href="#configure-the-internal-batch-processor" class="hash-link" aria-label="Direct link to Configure the internal batch processor" title="Direct link to Configure the internal batch processor">​</a></h3>
<p>The BulkProcessor inside es can further configure its behavior of how to refresh the cache operation request,
see the <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/connectors/datastream/elasticsearch/#elasticsearch-sink" target="_blank" rel="noopener noreferrer">official documentation</a> for details - <strong>Configuring the Internal</strong> Bulk Processor</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="apache-streampark-configuration">Apache StreamPark™ configuration<a href="#apache-streampark-configuration" class="hash-link" aria-label="Direct link to Apache StreamPark™ configuration" title="Direct link to Apache StreamPark™ configuration">​</a></h3>
<p>All other configurations must comply with the StreamPark configuration.
For <a href="/docs/development/config">specific configurable</a> items and the role of each parameter,
please refer to the project configuration</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/docs/framework/connector/5.es.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_WHnd" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_YCJs"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev paginationNavLink_UdUv" href="/docs/framework/connector/doris"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.2751 19.175L10.3251 18.125L5.4501 13.25H21.6001V11.75H5.4501L10.3251 6.87501L9.2751 5.82501L2.5751 12.5L9.2751 19.175Z" fill="currentColor"></path></svg><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Previous</div><div class="paginationNavLabel_YPzM pagination-nav__label">Apache Doris Connector</div></div></a><a class="pagination-nav__link pagination-nav__link--next paginationNavLink_UdUv" href="/docs/framework/connector/hbase"><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Next</div><div class="paginationNavLabel_YPzM pagination-nav__label">Apache HBase Connector</div></div><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.7249 19.175L13.6749 18.125L18.5499 13.25H2.3999V11.75H18.5499L13.6749 6.87501L14.7249 5.82501L21.4249 12.5L14.7249 19.175Z" fill="currentColor"></path></svg></a></nav></div></div><div class="col col--3"><div class="docTOCContainer_nkwD theme-doc-toc-desktop-container"><div class="tableOfContents_jeP5 thin-scrollbar docTOC_GnpH theme-doc-toc-desktop" style="opacity:0;transform:translateX(100px) translateZ(0)"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependency-of-elastic-writing" class="table-of-contents__link toc-highlight">Dependency of elastic writing</a></li><li><a href="#write-data-to-elasticsearch-based-on-the-official" class="table-of-contents__link toc-highlight">Write data to Elasticsearch based on the official</a></li><li><a href="#using-apache-streampark-writes-to-elasticsearch" class="table-of-contents__link toc-highlight">Using Apache StreamPark™ writes to Elasticsearch</a><ul><li><a href="#1-配置策略和连接信息" class="table-of-contents__link toc-highlight">1. 配置策略和连接信息</a></li><li><a href="#2-写入elasticsearch" class="table-of-contents__link toc-highlight">2. 写入Elasticsearch</a></li></ul></li><li><a href="#other-configuration" class="table-of-contents__link toc-highlight">Other configuration</a><ul><li><a href="#deal-with-failed-elasticsearch-request" class="table-of-contents__link toc-highlight">deal with failed Elasticsearch request</a></li><li><a href="#configure-the-internal-batch-processor" class="table-of-contents__link toc-highlight">Configure the internal batch processor</a></li><li><a href="#apache-streampark-configuration" class="table-of-contents__link toc-highlight">Apache StreamPark™ configuration</a></li></ul></li></ul></div></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Join Community</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box btns">
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark"><i class="fa fa-github"></i><span>Github</span></a>
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark/issues"><i class="fa fa-slack"></i><span>Issue Tracking</span></a>
                  <a class="btn btn-primary" href="javascript:void(0)">
                    <i class="fa fa-wechat"></i>
                    <span>Wechat</span>
                    <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>
        <div>
          <div style="margin-bottom: 30px;">
            <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
              <img alt="Apache Incubator logo" class="footer__logo" width="200">
            </a>
          </div>
          <div>
            <p>
            Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </p>
          </div>
        </div>

        <div>
          <span>
            Copyright © 2022-2024 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
          </span>
        </div>
      </div></div></div></div></footer></div>
</body>
</html>