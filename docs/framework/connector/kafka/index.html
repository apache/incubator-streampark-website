<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-framework/connector/kafka" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Apache Kafka Connector | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org/docs/framework/connector/kafka"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Apache Kafka Connector | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="Apache Flink® officially provides a connector to Apache Kafka connector for reading from or writing to a Kafka topic, providing exactly once processing semantics."><meta data-rh="true" property="og:description" content="Apache Flink® officially provides a connector to Apache Kafka connector for reading from or writing to a Kafka topic, providing exactly once processing semantics."><link data-rh="true" rel="icon" href="/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org/docs/framework/connector/kafka"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/connector/kafka" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/zh-CN/docs/framework/connector/kafka" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/connector/kafka" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/assets/css/styles.2815dd1e.css">
<script src="/assets/js/runtime~main.788200c2.js" defer="defer"></script>
<script src="/assets/js/main.237a4499.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_BCtO" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--light_uT2j"><img src="/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--dark_ENih"></div><b class="navbar__title text--truncate">StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/get-started/intro">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of conduct</a></li><li><a class="dropdown__link" href="/community/contribution_guide/mailing_lists">Join the mailing lists</a></li><li><a class="dropdown__link" href="/community/contribution_guide/become_committer">Become A Committer</a></li><li><a class="dropdown__link" href="/community/contribution_guide/become_pmc_member">Become A PMC member</a></li><li><a class="dropdown__link" href="/community/contribution_guide/new_committer_process">New Committer Process</a></li><li><a class="dropdown__link" href="/community/contribution_guide/new_pmc_ember_process">New PMC Member Process</a></li><li><a class="dropdown__link" href="/community/submit_guide/document">Documentation Notice</a></li><li><a class="dropdown__link" href="/community/submit_guide/submit_code">Submit Code</a></li><li><a class="dropdown__link" href="/community/submit_guide/code_style_and_quality_guide">Code style and quality guide</a></li><li><a class="dropdown__link" href="/community/submit_guide/documentation_style_guide">Documentation style guide</a></li><li><a class="dropdown__link" href="/community/release/how_to_release_version_2.1.x">How to release version 2.1.x</a></li><li><a class="dropdown__link" href="/community/release/how_to_verify_release">How to Verify Release</a></li></ul></div><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/user">Users</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><a href="https://github.com/apache/incubator-streampark" target="_blank" class="githubStars_qnS9"><div class="githubStarsContainer_O7dk"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.75C4.27062 1.75 1.25 4.77062 1.25 8.5C1.25 11.4869 3.18219 14.0097 5.86531 14.9041C6.20281 14.9631 6.32937 14.7606 6.32937 14.5834C6.32937 14.4231 6.32094 13.8916 6.32094 13.3263C4.625 13.6384 4.18625 12.9128 4.05125 12.5331C3.97531 12.3391 3.64625 11.74 3.35938 11.5797C3.12312 11.4531 2.78562 11.1409 3.35094 11.1325C3.8825 11.1241 4.26219 11.6219 4.38875 11.8244C4.99625 12.8453 5.96656 12.5584 6.35469 12.3813C6.41375 11.9425 6.59094 11.6472 6.785 11.4784C5.28312 11.3097 3.71375 10.7275 3.71375 8.14563C3.71375 7.41156 3.97531 6.80406 4.40563 6.33156C4.33812 6.16281 4.10187 5.47094 4.47312 4.54281C4.47312 4.54281 5.03844 4.36563 6.32937 5.23469C6.86937 5.08281 7.44313 5.00687 8.01688 5.00687C8.59063 5.00687 9.16438 5.08281 9.70438 5.23469C10.9953 4.35719 11.5606 4.54281 11.5606 4.54281C11.9319 5.47094 11.6956 6.16281 11.6281 6.33156C12.0584 6.80406 12.32 7.40312 12.32 8.14563C12.32 10.7359 10.7422 11.3097 9.24031 11.4784C9.485 11.6894 9.69594 12.0944 9.69594 12.7272C9.69594 13.63 9.6875 14.3556 9.6875 14.5834C9.6875 14.7606 9.81406 14.9716 10.1516 14.9041C12.8178 14.0097 14.75 11.4784 14.75 8.5C14.75 4.77062 11.7294 1.75 8 1.75Z" fill="currentColor"></path></svg><span class="githubText_YlX6">3.9k</span></div></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg></a><ul class="dropdown__menu"><li><a href="/docs/framework/connector/kafka" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-CN/docs/framework/connector/kafka" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">简体中文</a></li></ul></div><a class="colorModeButton_yITp undefined"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg></a><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_SuYZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_HgBb searchBarLoadingRing_om0w"><div></div><div></div><div></div><div></div></div></div></div><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_pmYA"><div class="docsWrapper_xNxE"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_yIRJ" type="button"></button><div class="docRoot_vmqG"><aside class="theme-doc-sidebar-container docSidebarContainer_hlm_"><div class="sidebarViewport_c8HV"><div class="sidebar_mhZE"><div class="sidebarSearchContainer_Lwc8"></div><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP" style="padding-top:1.75rem;padding-bottom:250px;overflow-y:auto"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/get-started/intro">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/platform/alert">Platform User Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/framework/dev-model">Development Framework</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/dev-model">Programming Paradigm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/config">Project Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/framework/connector/kafka">Connectors</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/framework/connector/kafka">Apache Kafka Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/jdbc">JDBC Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/clickhouse">ClickHouse Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/doris">Apache Doris Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/es">Elasticsearch Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/hbase">Apache HBase Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/http">HTTP Connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/framework/connector/redis">Redis Connector</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/development/development">Development Guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_Ke0w"><div class="container padding-top--md padding-bottom--lg"><div class="row" style="flex-wrap:nowrap"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_FXM1" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_vXXl"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Development Framework</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Connectors</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Apache Kafka Connector</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Apache Kafka Connector</h1></header><p><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html" target="_blank" rel="noopener noreferrer">Apache Flink® officially</a> provides a connector to <a href="https://kafka.apache.org" target="_blank" rel="noopener noreferrer">Apache Kafka</a> connector for reading from or writing to a Kafka topic, providing <strong>exactly once</strong> processing semantics.</p>
<p><code>KafkaSource</code> and <code>KafkaSink</code> in <code>StreamPark</code> are further encapsulated based on <code>kafka connector</code> from the official website, simplifying the development steps, making it easier to read and write data.</p>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="dependencies">Dependencies<a href="#dependencies" class="hash-link" aria-label="Direct link to Dependencies" title="Direct link to Dependencies">​</a></h2>
<p><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html" target="_blank" rel="noopener noreferrer">Apache Flink</a> integrates with the generic Kafka connector, which tries to keep up with the latest version of the Kafka client. The version of the Kafka client used by this connector may change between Flink versions. The current Kafka client is backward compatible with Kafka broker version 0.10.0 or later. For more details on Kafka compatibility, please refer to the <a href="https://kafka.apache.org/protocol.html#protocol_compatibility" target="_blank" rel="noopener noreferrer">Apache Kafka</a> official documentation.</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.streampark</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">streampark-flink-core</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-connector-kafka_2.11</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">1.12.0</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the development phase, the following dependencies are also necessary:</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-scala_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-clients_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">org.apache.flink</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">groupId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">flink-streaming-scala_${scala.binary.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">artifactId</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">${flink.version}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">version</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">provided</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">scope</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">dependency</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="kafka-source-consumer">Kafka Source (Consumer)<a href="#kafka-source-consumer" class="hash-link" aria-label="Direct link to Kafka Source (Consumer)" title="Direct link to Kafka Source (Consumer)">​</a></h2>
<p>First, we introduce the standard kafka consumer approach based on the official website, the following code is taken from the <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html#kafka-consumer" target="_blank" rel="noopener noreferrer">official website documentation</a>:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">val properties = new Properties()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">properties.setProperty(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">properties.setProperty(&quot;group.id&quot;, &quot;test&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val stream = env.addSource(new FlinkKafkaConsumer[String](&quot;topic&quot;, new SimpleStringSchema(), properties))</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see a series of kafka connection information defined. In this way, the parameters are hard-coded and insensitive. Let&#x27;s see how to use StreamPark to access data in Kafka. You need to define the configuration file in the rule format, and then write the code.</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="example">example<a href="#example" class="hash-link" aria-label="Direct link to example" title="Direct link to example">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> test_user</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">Cautions</div><p>The prefix <code>kafka.source</code> is fixed, and the parameters related to Kafka properties must comply with the official specification for setting the parameter key.</p></div></div>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">package org.apache.streampark.flink.quickstart</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object kafkaSourceApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        val source = KafkaSource().getDataStream[String]()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        print(source)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class KafkaSimpleJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        source.print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="advanced-configuration-parameters">Advanced configuration parameters<a href="#advanced-configuration-parameters" class="hash-link" aria-label="Direct link to Advanced configuration parameters" title="Direct link to Advanced configuration parameters">​</a></h3>
<p><code>KafkaSource</code> is based on the Flink Kafka Connector construct a simpler kafka reading class, the constructor needs to pass <code>StreamingContext</code>, when the program starts to pass the configuration file can be, framework will automatically parse the configuration file, when <code>new KafkaSource</code> it will automatically get the relevant information from the configuration file, initialize and return a Kafka Consumer, in this case, only configuration one topic, so in the consumption of the time without specifying the topic directly by default to get this topic to consume, this is the simple example, more complex rules and read operations through the <code>. getDataStream()</code> pass parameters in the method to achieve</p>
<p>Let&#x27;s look at the signature of the <code>getDataStream</code> method:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">def getDataStream[T: TypeInformation](topic: java.io.Serializable = null,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    alias: String = &quot;&quot;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    deserializer: KafkaDeserializationSchema[T],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    strategy: WatermarkStrategy[KafkaRecord[T]] = null</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">): DataStream[KafkaRecord[T]]</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The specific description of the parameters are as follows:</p>
<table><thead><tr><th style="text-align:left">Parameter Name</th><th style="text-align:left">Parameter Type</th><th style="text-align:left">Description</th><th style="text-align:left">Default</th></tr></thead><tbody><tr><td style="text-align:left"><code>topic</code></td><td style="text-align:left">Serializable</td><td style="text-align:left">a topic or group of topics</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>alias</code></td><td style="text-align:left">String</td><td style="text-align:left">distinguish different kafka instances</td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>deserializer</code></td><td style="text-align:left">DeserializationSchema</td><td style="text-align:left">deserialize class of the data in the topic</td><td style="text-align:left">KafkaStringDeserializationSchema</td></tr><tr><td style="text-align:left"><code>strategy</code></td><td style="text-align:left">WatermarkStrategy</td><td style="text-align:left">watermark generation strategy</td><td style="text-align:left"></td></tr></tbody></table>
<p>Let&#x27;s take a look at more usage and configuration methods.</p>
<div class="counter"><ul>
<li>Consume multiple Kafka instances</li>
<li>Consume multiple topics</li>
<li>Topic dynamic discovery</li>
<li>Consume from the specified offset</li>
<li>Specific KafkaDeserializationSchema</li>
<li>Specific WatermarkStrategy</li>
</ul></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="consume-multiple-kafka-instances">Consume multiple Kafka instances<a href="#consume-multiple-kafka-instances" class="hash-link" aria-label="Direct link to Consume multiple Kafka instances" title="Direct link to Consume multiple Kafka instances">​</a></h3>
<p><code>StreamPark</code> has taken into account the configuration of kafka of multiple different instances at the beginning of development . How to unify the configuration, and standardize the format? The solution in streampark is this, if we want to consume two different instances of kafka at the same time, the configuration file is defined as follows,
As you can see in the <code>kafka.source</code> directly under the kafka instance name, here we unified called <strong>alias</strong> , <strong>alias</strong> must be unique, to distinguish between different instances
If there is only one kafka instance, then you can not configure <code>alias</code>
When writing the code for consumption, pay attention to the corresponding <strong>alias</strong> can be specified, the configuration and code is as follows</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Setting</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">kafka1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> test_user</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">kafka2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kafka2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kafka2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">enable.auto.commit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">KafkaSource().getDataStream[String](alias = &quot;kafka1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">KafkaSource().getDataStream[String](alias = &quot;kafka2&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .uid(&quot;kfkSource2&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .name(&quot;kfkSource2&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .alias(&quot;kafka1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; source2 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .alias(&quot;kafka2&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">context.start();</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">Cautions</div><p>When writing code in java api, be sure to place the settings of these parameters such as <code>alias</code> before calling <code>getDataStream()</code></p></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="consume-multiple-topics">Consume multiple topics<a href="#consume-multiple-topics" class="hash-link" aria-label="Direct link to Consume multiple topics" title="Direct link to Consume multiple topics">​</a></h3>
<p>Configure the consumption of multiple topic is also very simple, in the configuration file <code>topic</code> can be configured under multiple topic name, separated by <code>,</code> or space, in the <code>scala</code> api, if the consumption of a topic, then directly pass the topic name can be, if you want to consume multiple, pass a <code>List</code> can be
<code>java</code> api through the <code>topic()</code> method to pass in the topic name, which is a variable parameter of type String, can be accepted in one or more <code>topic</code> name, configuration and code as follows</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Setting</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> topic1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">topic2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">topic3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(106, 153, 85)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">KafkaSource().getDataStream[String](topic = &quot;topic1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  .print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">KafkaSource().getDataStream[String](topic = List(&quot;topic1&quot;,&quot;topic2&quot;,&quot;topic3&quot;))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .topic(&quot;topic1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; source1 = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .topic(&quot;topic1&quot;,&quot;topic2&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">tip</div><p><code>topic</code> supports configuring multiple instances of <code>topic</code>, each <code>topic</code> is directly separated by <code>,</code> or separated by spaces, if multiple instances are configured under the topic, the specific topic name must be specified when consuming</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="topic-dynamic-discovery">Topic dynamic discovery<a href="#topic-dynamic-discovery" class="hash-link" aria-label="Direct link to Topic dynamic discovery" title="Direct link to Topic dynamic discovery">​</a></h3>
<p>Regarding kafka&#x27;s partition dynamics, by default, partition discovery is disabled. To enable it, please set <code>flink.partition-discovery.interval-millis</code> to greater than <code>0</code> in the provided configuration, which means the interval between partition discovery is in milliseconds
For more details, please refer to the <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#partition-discovery" target="_blank" rel="noopener noreferrer">official website documentation</a></p>
<p>Flink Kafka Consumer is also able to discover Topics using regular expressions, please refer to the <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#topic-discovery" target="_blank" rel="noopener noreferrer">official website documentation</a>
A simpler way is provided in <code>StreamPark</code>, you need to configure the regular pattern of the matching <code>topic</code> instance name in <code>pattern</code></p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Setting</li><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">pattern</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ^topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_02</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(106, 153, 85)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">KafkaSource().getDataStream[String](topic = &quot;topic-a&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.uid(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.name(&quot;kfkSource1&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.print()</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .topic(&quot;topic-a&quot;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">context.start();</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-danger alert alert--danger admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">Cautions</div><p><code>topic</code> and <code>pattern</code> can not be configured at the same time, when configured with <code>pattern</code> regular match, you can still specify a definite <code>topic</code> name, at this time, will check whether <code>pattern</code> matches the current <code>topic</code>, if not, will be reported an error</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="consume-from-the-specified-offset">Consume from the specified offset<a href="#consume-from-the-specified-offset" class="hash-link" aria-label="Direct link to Consume from the specified offset" title="Direct link to Consume from the specified offset">​</a></h3>
<p>Flink Kafka Consumer allows the starting position of Kafka partitions to be determined by configuration, <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#kafka-consumers-start-position-configuration" target="_blank" rel="noopener noreferrer">official website documentation</a> The starting position of a Kafka partition is specified as follows</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">val env = StreamExecutionEnvironment.getExecutionEnvironment()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val myConsumer = new FlinkKafkaConsumer[String](...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromEarliest()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromLatest()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromTimestamp(...)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromGroupOffsets()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val stream = env.addSource(myConsumer)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FlinkKafkaConsumer&lt;String&gt; myConsumer = new FlinkKafkaConsumer&lt;&gt;(...);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromEarliest();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromLatest();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromTimestamp(...);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">myConsumer.setStartFromGroupOffsets();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DataStream&lt;String&gt; stream = env.addSource(myConsumer);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>This setting is not recommended in <code>StreamPark</code>, a more convenient way is provided by specifying <code>auto.offset.reset</code> in the configuration</p>
<ul>
<li><code>earliest</code> consume from earliest record</li>
<li><code>latest</code> consume from latest record</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="consume-from-the-specified-offset-1">Consume from the specified offset<a href="#consume-from-the-specified-offset-1" class="hash-link" aria-label="Direct link to Consume from the specified offset" title="Direct link to Consume from the specified offset">​</a></h3>
<p>You can also specify the offset to start consumption for each partition, simply by configuring the <code>start.from</code> related information in the following configuration file</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> topic1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">topic2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">topic3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest </span><span class="token comment" style="color:rgb(106, 153, 85)"># (earliest | latest)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">start.from</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">timestamp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1591286400000</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Specify timestamp to take effect for all topics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">offset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Specify an offset for the topic&#x27;s partition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> topic_abc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">topic_123</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">topic_abc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">182</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">183</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">182</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Partition 0 starts consumption from 182, partition 1 starts from 183, and partition 2 starts from 182...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">topic_123</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">182</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">183</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">182</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="specific-deserializer">Specific deserializer<a href="#specific-deserializer" class="hash-link" aria-label="Direct link to Specific deserializer" title="Direct link to Specific deserializer">​</a></h3>
<p>If you do not specify <code>deserializer</code>, the data in the topic will be deserialized by using String by default. At the same time, you can also manually specify <code>deserializer</code>. The complete code is as follows</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.java.typeutils.TypeExtractor.getForClass</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object KafkaSourceApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        KafkaSource()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .getDataStream[String](deserializer = new UserSchema)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .map(_.value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class UserSchema extends KafkaDeserializationSchema[User] {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def isEndOfStream(nextElement: User): Boolean = false</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def getProducedType: TypeInformation[User] = getForClass(classOf[User])</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def deserialize(record: ConsumerRecord[Array[Byte], Array[Byte]]): User = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val value = new String(record.value())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    JsonUtils.read[User](value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">case class User(name:String,age:Int,gender:Int,address:String)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import static org.apache.flink.api.java.typeutils.TypeExtractor.getForClass;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class KafkaSourceJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        new KafkaSource&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .deserializer(new JavaUserSchema())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;JavaUser&gt;, JavaUser&gt;) KafkaRecord::value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUserSchema implements KafkaDeserializationSchema&lt;JavaUser&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    private ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public boolean isEndOfStream(JavaUser nextElement) return false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public TypeInformation&lt;JavaUser&gt; getProducedType() return getForClass(JavaUser.class);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public JavaUser deserialize(ConsumerRecord&lt;byte[], byte[]&gt; record) throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        String value = new String(record.value());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return mapper.readValue(value, JavaUser.class);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="return-record-kafka-record">Return record Kafka Record<a href="#return-record-kafka-record" class="hash-link" aria-label="Direct link to Return record Kafka Record" title="Direct link to Return record Kafka Record">​</a></h3>
<p>The returned object is wrapped in a <code>KafkaRecord</code>, which has the current <code>offset</code>, <code>partition</code>, <code>timestamp</code> and many other useful information for developers to use, where <code>value</code> is the target object returned, as shown below:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/streampark_kafkaapi-c3eb75726e1ec7cb8788dea846c54933.jpeg" width="1936" height="1196" class="img__KcZ"></p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="specific-strategy">Specific strategy<a href="#specific-strategy" class="hash-link" aria-label="Direct link to Specific strategy" title="Direct link to Specific strategy">​</a></h3>
<p>In many case, the timestamp of the record is embedded (explicitly or implicitly) in the record itself. In addition, users may want to specify in a custom way, for example a special record in a <code>Kafka</code> stream containing a <code>watermark</code> of the current event time. For these cases, <code>Flink Kafka Consumer</code> is allowed to specify <code>AssignerWithPeriodicWatermarks</code> or <code>AssignerWithPunctuatedWatermarks</code>.</p>
<p>In the <code>StreamPark</code> run pass a <code>WatermarkStrategy</code> as a parameter to assign a <code>Watermark</code>, for example, parse the data in the <code>topic</code> as a <code>user</code> object, there is an <code>orderTime</code> in <code>user</code> which is a time type, we use this as a base to assign a <code>Watermark</code> to it</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.{KafkaRecord, KafkaSource}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.eventtime.{SerializableTimestampAssigner, WatermarkStrategy}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.java.typeutils.TypeExtractor.getForClass</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.time.Duration</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.Date</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object KafkaSourceStrategyApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    KafkaSource()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .getDataStream[User](</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        deserializer = new UserSchema,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        strategy = WatermarkStrategy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .forBoundedOutOfOrderness[KafkaRecord[User]](Duration.ofMinutes(1))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          .withTimestampAssigner(new SerializableTimestampAssigner[KafkaRecord[User]] {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            override def extractTimestamp(element: KafkaRecord[User], recordTimestamp: Long): Long = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              element.value.orderTime.getTime</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      ).map(_.value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      .print()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class UserSchema extends KafkaDeserializationSchema[User] {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def isEndOfStream(nextElement: User): Boolean = false</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def getProducedType: TypeInformation[User] = getForClass(classOf[User])</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def deserialize(record: ConsumerRecord[Array[Byte], Array[Byte]]): User = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val value = new String(record.value())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    JsonUtils.read[User](value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String, orderTime: Date)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.eventtime.SerializableTimestampAssigner;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.eventtime.WatermarkStrategy;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.typeinfo.TypeInformation;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.connectors.kafka.KafkaDeserializationSchema;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.kafka.clients.consumer.ConsumerRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.time.Duration;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.util.Date;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import static org.apache.flink.api.java.typeutils.TypeExtractor.getForClass;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class KafkaSourceStrategyJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        new KafkaSource&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .deserializer(new JavaUserSchema())</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .strategy(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        WatermarkStrategy.&lt;KafkaRecord&lt;JavaUser&gt;&gt;forBoundedOutOfOrderness(Duration.ofMinutes(1))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                .withTimestampAssigner(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                        (SerializableTimestampAssigner&lt;KafkaRecord&lt;JavaUser&gt;&gt;)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                                (element, recordTimestamp) -&gt; element.value().orderTime.getTime()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;JavaUser&gt;, JavaUser&gt;) KafkaRecord::value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .print();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUserSchema implements KafkaDeserializationSchema&lt;JavaUser&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    private ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public boolean isEndOfStream(JavaUser nextElement) return false;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public TypeInformation&lt;JavaUser&gt; getProducedType() return getForClass(JavaUser.class);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    @Override public JavaUser deserialize(ConsumerRecord&lt;byte[], byte[]&gt; record) throws Exception {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        String value = new String(record.value());</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return mapper.readValue(value, JavaUser.class);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Date orderTime;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">Cautions</div><p>If the <code>watermark assigner</code> relies on messages read from <code>Kafka</code> to raise the <code>watermark</code> (which is usually the case), then all topics and partitions need to have a continuous stream of messages. Otherwise, <strong>the application&#x27;s <code>watermark</code> will not rise</strong> and all time-based arithmetic (such as time windows or functions with timers) will not work. A single <code>Kafka</code> partition can also cause this reaction. Consider setting the appropriate <strong><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamps_watermarks.html#dealing-with-idle-sources" target="_blank" rel="noopener noreferrer"><code>idelness timeouts</code></a></strong> to mitigate this problem.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="kafka-sink-producer">Kafka Sink (Producer)<a href="#kafka-sink-producer" class="hash-link" aria-label="Direct link to Kafka Sink (Producer)" title="Direct link to Kafka Sink (Producer)">​</a></h2>
<p>In <code>StreamPark</code> the <code>Kafka Producer</code> is called <code>KafkaSink</code>, which allows messages to be written to one or more <code>Kafka topics</code>.</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain"> val source = KafkaSource().getDataStream[String]().map(_.value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> KafkaSink().sink(source)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain"> StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> new KafkaSink&lt;String&gt;(context).sink(source);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> context.start();</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p><code>sink</code> is a specific method for writing data, and the list of parameters is as follows</p>
<table><thead><tr><th style="text-align:left">Parameter Name</th><th style="text-align:left">Parameter Type</th><th style="text-align:left">Description</th><th style="text-align:left">Default</th><th style="text-align:left">Required</th></tr></thead><tbody><tr><td style="text-align:left"><code>stream</code></td><td style="text-align:left">DataStream[T]</td><td style="text-align:left">data stream to write</td><td style="text-align:left"></td><td style="text-align:left">yes</td></tr><tr><td style="text-align:left"><code>alias</code></td><td style="text-align:left">String</td><td style="text-align:left"><code>kafka</code> instance alias</td><td style="text-align:left"></td><td style="text-align:left">no</td></tr><tr><td style="text-align:left"><code>serializationSchema</code></td><td style="text-align:left">SerializationSchema[T]</td><td style="text-align:left">serializer written</td><td style="text-align:left">SimpleStringSchema</td><td style="text-align:left">no</td></tr><tr><td style="text-align:left"><code>partitioner</code></td><td style="text-align:left">FlinkKafkaPartitioner[T]</td><td style="text-align:left">kafka partitioner</td><td style="text-align:left">KafkaEqualityPartitioner[T]</td><td style="text-align:left">no</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="fault-tolerance-and-semantics">Fault Tolerance and Semantics<a href="#fault-tolerance-and-semantics" class="hash-link" aria-label="Direct link to Fault Tolerance and Semantics" title="Direct link to Fault Tolerance and Semantics">​</a></h3>
<p>After enabling Flink&#x27;s <code>checkpointing</code>, <code>KafkaSink</code> can provide <code>once-exactly</code> semantic, please refer to Chapter 2 on <a href="/docs/development/config/#checkpoints">project configuration</a> for the specific setting of <code>checkpointing</code>.</p>
<p>In addition to enabling checkpointing for Flink, you can also choose from three different modes  by passing the appropriate <code>semantic</code> parameters to <code>KafkaSink</code></p>
<div class="counter"><ul>
<li>EXACTLY_ONCE  Provide exactly-once semantics with Kafka transactions</li>
<li>AT_LEAST_ONCE At least once, it is guaranteed that no records will be lost (but records may be duplicated)</li>
<li>NONE Flink There is no guarantee of semantics, and the resulting records may be lost or duplicated</li>
</ul></div>
<p>configure <code>semantic</code> under the <code>kafka.sink</code></p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.sink</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(106, 153, 85)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_oKNz alert alert--info details_r1OI" data-collapsed="true"><summary> kafka <code>EXACTLY_ONCE</code> Semantic Description</summary><div><div class="collapsibleContent_fbKL"><p>The <code>Semantic.EXACTLY_ONCE</code> relies on the ability for transactions to be committed. Transaction commits occur before the checkpoint is triggered and after recovery from the checkpoint. If the time between a Flink application crash and a full restart exceeds Kafka&#x27;s transaction timeout, then there will be caused data loss (Kafka automatically discards transactions that exceed the timeout). With this in mind, please configure the transaction timeout time based on the expected downtime.</p><p>By default, the Kafka broker sets transaction.max.timeout.ms to 15 minutes. This property does not allow setting the transaction timeout larger than producers value. By default, FlinkKafkaProducer sets the transaction.timeout.ms property in the producer config to 1 hour, so you should increase the transaction.max.timeout. ms before using Semantic.</p><p>In the read_committed mode of KafkaConsumer, any uncompleted (neither aborted nor completed) transaction will block all reads after the uncompleted transaction from the given Kafka topic. In other words, after following the following sequence of events.</p><div class="counter"><ul>
<li>User started transaction1 and used it to write some records</li>
<li>User started transaction2 and used it to write some other records</li>
<li>User committed transaction2</li>
</ul></div><p>Even if the records in transaction2 are committed, they will not be visible to the consumer until transaction1 is committed or aborted. This has 2 levels of implications.</p><ul>
<li>First, during normal operation of the Flink application, the user can expect a delay in the visibility of records, it equals to the average time between completed checkpoints.</li>
<li>Second, in the case of a failed Flink application, the topic written by this application will be blocked until the application is restarted or the configured transaction timeout has elapsed, and normalcy will resume. This annotation only applies multi agents or applications writing to the same Kafka topic.</li>
</ul><p>Note: The <code>Semantic.EXACTLY_ONCE</code> mode uses a fixed size pool of KafkaProducers for each FlinkKafkaProducer instance. Each checkpoint uses one of the producers. If the number of concurrent checkpoints exceeds the pool size, FlinkKafkaProducer will throw an exception and cause the entire application to fail. Please configure the maximum pool size and the maximum number of concurrent checkpoints wisely.</p><p>Note: <code>Semantic.EXACTLY_ONCE</code> will do everything possible to not leave any stay transactions that would otherwise block other consumers from reading data from this Kafka topic. However, if a Flink application fails before the first checkpoint, there will be no information about the previous pool size in the system after restarting such an application. Therefore, it is not safe to scale down a Flink application before the first checkpoint is completed and the concurrent number of scaling is greater than the value of the safety factor FlinkKafkaProducer.SAFE_SCALE_DOWN_FACTOR.</p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="multiple-instance-kafka-specifies-alias">Multiple instance kafka specifies alias<a href="#multiple-instance-kafka-specifies-alias" class="hash-link" aria-label="Direct link to Multiple instance kafka specifies alias" title="Direct link to Multiple instance kafka specifies alias">​</a></h3>
<p>If there are multiple instances of kafka that need to be configured at the time of writing, used <code>alias</code> to distinguish between multi kafka instances, configured as follows:</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">kafka.sink</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">kafka_cluster1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(106, 153, 85)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">kafka_cluster2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk6</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk_sink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">transaction.timeout.ms</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">semantic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> AT_LEAST_ONCE </span><span class="token comment" style="color:rgb(106, 153, 85)"># EXACTLY_ONCE|AT_LEAST_ONCE|NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">batch.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When writing data, you need to manually specify <code>alias</code>. Note that the <code>scala</code> api and <code>java</code> api are different in code. <code>scala</code> specifies parameters directly in the <code>sink</code> method, while the <code>java</code> api is It is set by the <code>alias()</code> method</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain"> val source = KafkaSource().getDataStream[String]().map(_.value)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> KafkaSink().sink(source,alias = &quot;kafka_cluster1&quot;)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain"> StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> DataStream&lt;String&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         .map((MapFunction&lt;KafkaRecord&lt;String&gt;, String&gt;) KafkaRecord::value);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> new KafkaSink&lt;String&gt;(context).alias(&quot;kafka_cluster1&quot;).sink(source);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> context.start();</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="specific-serializationschema">Specific SerializationSchema<a href="#specific-serializationschema" class="hash-link" aria-label="Direct link to Specific SerializationSchema" title="Direct link to Specific SerializationSchema">​</a></h3>
<p><code>Flink Kafka Producer</code> needs know how to convert Java/Scala objects to binary data. KafkaSerializationSchema allows users to specify such a schema, please refer to the <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#the-serializationschema" target="_blank" rel="noopener noreferrer">official documentation</a> for how to do this and documentation</p>
<p>In <code>KafkaSink</code>, the default serialization is not specified, and the <code>SimpleStringSchema</code> is used for serialization, where the developer can specify a custom serializer, specified by the <code>serializationSchema</code> parameter, for example, to write the <code>user</code> object to a custom format <code>kafka</code></p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object KafkaSinkApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val source = KafkaSource()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.getDataStream[String]()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.map(x =&gt; JsonUtils.read[User](x.value))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    KafkaSink().sink[User](source, serialization = new SerializationSchema[User]() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      override def serialize(user: User): Array[Byte] = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        s&quot;${user.name},${user.age},${user.gender},${user.address}&quot;.getBytes</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.sink.KafkaSink;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.FilterFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class kafkaSinkJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;JavaUser&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, JavaUser&gt;) value -&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        mapper.readValue(value.value(), JavaUser.class));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        new KafkaSink&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .serializer(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        (SerializationSchema&lt;JavaUser&gt;) element -&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                String.format(&quot;%s,%d,%d,%s&quot;, element.name, element.age, element.gender, element.address).getBytes()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                ).sink(source);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="specific-serializationschema-1">Specific SerializationSchema<a href="#specific-serializationschema-1" class="hash-link" aria-label="Direct link to Specific SerializationSchema" title="Direct link to Specific SerializationSchema">​</a></h3>
<p><code>Flink Kafka Producer</code> needs know how to convert Java/Scala objects to binary data. KafkaSerializationSchema allows users to specify such a schema, please refer to the <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html#the-serializationschema" target="_blank" rel="noopener noreferrer">official documentation</a> for how to do this and documentation</p>
<p>In <code>KafkaSink</code>, the default serialization is not specified, and the <code>SimpleStringSchema</code> is used for serialization, where the developer can specify a custom serializer, specified by the <code>serializationSchema</code> parameter, for example, to write the <code>user</code> object to a custom format <code>kafka</code></p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.common.util.JsonUtils</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.sink.JdbcSink</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaSource</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object KafkaSinkApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">val source = KafkaSource()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.getDataStream[String]()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">.map(x =&gt; JsonUtils.read[User](x.value))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    KafkaSink().sink[User](source, serialization = new SerializationSchema[User]() {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      override def serialize(user: User): Array[Byte] = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        s&quot;${user.name},${user.age},${user.gender},${user.address}&quot;.getBytes</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">case class User(name: String, age: Int, gender: Int, address: String)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.function.StreamEnvConfigFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.sink.KafkaSink;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.java.source.KafkaSource;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamingContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.source.KafkaRecord;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.FilterFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.functions.MapFunction;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.common.serialization.SerializationSchema;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.streaming.api.datastream.DataStream;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import java.io.Serializable;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class kafkaSinkJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig envConfig = new StreamEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(envConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ObjectMapper mapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        DataStream&lt;JavaUser&gt; source = new KafkaSource&lt;String&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .getDataStream()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .map((MapFunction&lt;KafkaRecord&lt;String&gt;, JavaUser&gt;) value -&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        mapper.readValue(value.value(), JavaUser.class));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        new KafkaSink&lt;JavaUser&gt;(context)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .serializer(</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        (SerializationSchema&lt;JavaUser&gt;) element -&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                String.format(&quot;%s,%d,%d,%s&quot;, element.name, element.age, element.gender, element.address).getBytes()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                ).sink(source);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class JavaUser implements Serializable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer age;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Integer gender;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    String address;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="specific-partitioner">specific partitioner<a href="#specific-partitioner" class="hash-link" aria-label="Direct link to specific partitioner" title="Direct link to specific partitioner">​</a></h3>
<p><code>KafkaSink</code> allows you to specify a kafka partitioner, if you don&#x27;t specify it, the default is to use <code>StreamPark</code> built-in <strong>KafkaEqualityPartitioner</strong> partitioner, as the name, the partitioner can write data to each partition evenly, the <code>scala</code> api is set by the <code> partitioner</code> parameter to set the partitioner,
<code>java</code> api is set by <code>partitioner()</code> method</p>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">Cautions</div><p>The default partitioner used in Flink Kafka Connector is <strong>FlinkFixedPartitioner</strong>, which requires special attention to the parallelism of <code>sink</code> and the number of partitions of <code>kafka</code>, otherwise it will write to a partition</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/docs/framework/connector/1.kafka.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_WHnd" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_YCJs"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev paginationNavLink_UdUv" href="/docs/framework/quick-start"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.2751 19.175L10.3251 18.125L5.4501 13.25H21.6001V11.75H5.4501L10.3251 6.87501L9.2751 5.82501L2.5751 12.5L9.2751 19.175Z" fill="currentColor"></path></svg><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Previous</div><div class="paginationNavLabel_YPzM pagination-nav__label">Quick Start</div></div></a><a class="pagination-nav__link pagination-nav__link--next paginationNavLink_UdUv" href="/docs/framework/connector/jdbc"><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Next</div><div class="paginationNavLabel_YPzM pagination-nav__label">JDBC Connector</div></div><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.7249 19.175L13.6749 18.125L18.5499 13.25H2.3999V11.75H18.5499L13.6749 6.87501L14.7249 5.82501L21.4249 12.5L14.7249 19.175Z" fill="currentColor"></path></svg></a></nav></div></div><div class="col col--3"><div class="docTOCContainer_nkwD theme-doc-toc-desktop-container"><div class="tableOfContents_jeP5 thin-scrollbar docTOC_GnpH theme-doc-toc-desktop" style="opacity:0;transform:translateX(100px) translateZ(0)"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#kafka-source-consumer" class="table-of-contents__link toc-highlight">Kafka Source (Consumer)</a><ul><li><a href="#example" class="table-of-contents__link toc-highlight">example</a></li><li><a href="#advanced-configuration-parameters" class="table-of-contents__link toc-highlight">Advanced configuration parameters</a></li><li><a href="#consume-multiple-kafka-instances" class="table-of-contents__link toc-highlight">Consume multiple Kafka instances</a></li><li><a href="#consume-multiple-topics" class="table-of-contents__link toc-highlight">Consume multiple topics</a></li><li><a href="#topic-dynamic-discovery" class="table-of-contents__link toc-highlight">Topic dynamic discovery</a></li><li><a href="#consume-from-the-specified-offset" class="table-of-contents__link toc-highlight">Consume from the specified offset</a></li><li><a href="#consume-from-the-specified-offset-1" class="table-of-contents__link toc-highlight">Consume from the specified offset</a></li><li><a href="#specific-deserializer" class="table-of-contents__link toc-highlight">Specific deserializer</a></li><li><a href="#return-record-kafka-record" class="table-of-contents__link toc-highlight">Return record Kafka Record</a></li><li><a href="#specific-strategy" class="table-of-contents__link toc-highlight">Specific strategy</a></li></ul></li><li><a href="#kafka-sink-producer" class="table-of-contents__link toc-highlight">Kafka Sink (Producer)</a><ul><li><a href="#fault-tolerance-and-semantics" class="table-of-contents__link toc-highlight">Fault Tolerance and Semantics</a></li><li><a href="#multiple-instance-kafka-specifies-alias" class="table-of-contents__link toc-highlight">Multiple instance kafka specifies alias</a></li><li><a href="#specific-serializationschema" class="table-of-contents__link toc-highlight">Specific SerializationSchema</a></li><li><a href="#specific-serializationschema-1" class="table-of-contents__link toc-highlight">Specific SerializationSchema</a></li><li><a href="#specific-partitioner" class="table-of-contents__link toc-highlight">specific partitioner</a></li></ul></li></ul></div></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Join Community</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box btns">
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark"><i class="fa fa-github"></i><span>Github</span></a>
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark/issues"><i class="fa fa-slack"></i><span>Issue Tracking</span></a>
                  <a class="btn btn-primary" href="javascript:void(0)">
                    <i class="fa fa-wechat"></i>
                    <span>Wechat</span>
                    <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>
        <div>
          <div style="margin-bottom: 30px;">
            <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
              <img alt="Apache Incubator logo" class="footer__logo" width="200">
            </a>
          </div>
          <div>
            <p>
            Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </p>
          </div>
        </div>

        <div>
          <span>
            Copyright © 2022-2024 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
          </span>
        </div>
      </div></div></div></div></footer></div>
</body>
</html>