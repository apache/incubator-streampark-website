<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-framework/config" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">项目配置 | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org/zh-CN/docs/framework/config"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="项目配置 | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="配置在StreamPark中是非常重要的概念,先说说为什么需要配置"><meta data-rh="true" property="og:description" content="配置在StreamPark中是非常重要的概念,先说说为什么需要配置"><link data-rh="true" rel="icon" href="/zh-CN/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org/zh-CN/docs/framework/config"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/config" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/zh-CN/docs/framework/config" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/config" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/zh-CN/assets/css/styles.973b1f1a.css">
<script src="/zh-CN/assets/js/runtime~main.470707f1.js" defer="defer"></script>
<script src="/zh-CN/assets/js/main.ef599892.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_BCtO" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--light_uT2j"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--dark_ENih"></div><b class="navbar__title text--truncate">StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/get-started/intro">文档</a><a class="navbar__item navbar__link" href="/zh-CN/download">下载</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">社区</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">行为守则</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/mailing_lists">加入邮件列表</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_committer">成为 Committer</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_pmc_member">成为 PMC 成员</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_committer_process">新的 Committer 流程</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_pmc_ember_process">新的 PMC 成员流程</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/document">文档</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/submit_code">提交代码</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/code_style_and_quality_guide">代码风格和质量指南</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/documentation_style_guide">文档书写规范</a></li><li><a class="dropdown__link" href="/zh-CN/community/release/how_to_release_version_2.1.x">How to release version 2.1.x</a></li><li><a class="dropdown__link" href="/zh-CN/community/release/how_to_verify_release">如何验证发版</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/team">团队</a><a class="navbar__item navbar__link" href="/zh-CN/user">用户</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">基金会</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">证书</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">事件</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">安全</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">致谢</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/blog">博客</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><a href="https://github.com/apache/incubator-streampark" target="_blank" class="githubStars_qnS9"><div class="githubStarsContainer_O7dk"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.75C4.27062 1.75 1.25 4.77062 1.25 8.5C1.25 11.4869 3.18219 14.0097 5.86531 14.9041C6.20281 14.9631 6.32937 14.7606 6.32937 14.5834C6.32937 14.4231 6.32094 13.8916 6.32094 13.3263C4.625 13.6384 4.18625 12.9128 4.05125 12.5331C3.97531 12.3391 3.64625 11.74 3.35938 11.5797C3.12312 11.4531 2.78562 11.1409 3.35094 11.1325C3.8825 11.1241 4.26219 11.6219 4.38875 11.8244C4.99625 12.8453 5.96656 12.5584 6.35469 12.3813C6.41375 11.9425 6.59094 11.6472 6.785 11.4784C5.28312 11.3097 3.71375 10.7275 3.71375 8.14563C3.71375 7.41156 3.97531 6.80406 4.40563 6.33156C4.33812 6.16281 4.10187 5.47094 4.47312 4.54281C4.47312 4.54281 5.03844 4.36563 6.32937 5.23469C6.86937 5.08281 7.44313 5.00687 8.01688 5.00687C8.59063 5.00687 9.16438 5.08281 9.70438 5.23469C10.9953 4.35719 11.5606 4.54281 11.5606 4.54281C11.9319 5.47094 11.6956 6.16281 11.6281 6.33156C12.0584 6.80406 12.32 7.40312 12.32 8.14563C12.32 10.7359 10.7422 11.3097 9.24031 11.4784C9.485 11.6894 9.69594 12.0944 9.69594 12.7272C9.69594 13.63 9.6875 14.3556 9.6875 14.5834C9.6875 14.7606 9.81406 14.9716 10.1516 14.9041C12.8178 14.0097 14.75 11.4784 14.75 8.5C14.75 4.77062 11.7294 1.75 8 1.75Z" fill="currentColor"></path></svg><span class="githubText_YlX6">3.9k</span></div></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg></a><ul class="dropdown__menu"><li><a href="/docs/framework/config" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-CN/docs/framework/config" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">简体中文</a></li></ul></div><a class="colorModeButton_yITp undefined"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg></a><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_SuYZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_HgBb searchBarLoadingRing_om0w"><div></div><div></div><div></div><div></div></div></div></div><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_pmYA"><div class="docsWrapper_xNxE"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_yIRJ" type="button"></button><div class="docRoot_vmqG"><aside class="theme-doc-sidebar-container docSidebarContainer_hlm_"><div class="sidebarViewport_c8HV"><div class="sidebar_mhZE"><div class="sidebarSearchContainer_Lwc8"></div><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_Y1UP" style="padding-top:1.75rem;padding-bottom:250px;overflow-y:auto"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/get-started/intro">快速开始</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/platform/alert">平台使用手册</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/docs/framework/dev-model">开发框架</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/framework/dev-model">编程模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/framework/config">项目配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/framework/quick-start">快速开始</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/zh-CN/docs/framework/connector/kafka">连接器</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/development/development">开发者指南</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_Ke0w"><div class="container padding-top--md padding-bottom--lg"><div class="row" style="flex-wrap:nowrap"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_FXM1" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_vXXl"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">开发框架</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">项目配置</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>项目配置</h1></header><p>配置在<code>StreamPark</code>中是非常重要的概念,先说说为什么需要配置</p>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="为什么需要配置">为什么需要配置<a href="#为什么需要配置" class="hash-link" aria-label="为什么需要配置的直接链接" title="为什么需要配置的直接链接">​</a></h2>
<p>开发<code>DataStream</code>程序,大体流程都可以抽象为以下4步</p>
<ul>
<li>StreamExecutionEnvironment初始并配置</li>
<li>Source接入数据</li>
<li>Transformation逻辑处理</li>
<li>Sink结果数据落地</li>
</ul>
<p><img decoding="async" loading="lazy" src="/zh-CN/assets/images/process_steps-602d682d0f781a6178e3793ed9e434e7.png" width="1070" height="243" class="img__KcZ"></p>
<p>开发<code>DataStream</code>程序都需要定义<code>Environment</code>初始化并且配置环境相关的参数,一般我们都会在第一步初始化<code>Environment</code>并配置各种参数,配置的参数大概有以下几类</p>
<ul>
<li>Parallelism 默认并行度配置</li>
<li>TimeCharacteristic 时间特征配置</li>
<li>checkpoint 检查点的相关配置</li>
<li>Watermark 相关配置</li>
<li>State Backend 状态后端配置</li>
<li>Restart Strategy 重启策略配置</li>
<li>其他配置...</li>
</ul>
<p>以上的配置基本都是比较普遍且通用的,是每个程序上来第一步就要定义的,是一项重复的工作</p>
<p>当程序写好后,要上线运行,任务启动提交都差不多用下面的命令行的方式,设置各种启动参数,
这时就得开发者清楚的知道每个参数的含义,如果再设置几个  运行时资源参数,那启动命名会很长,可读性很差,参数解析用到了强校验,一旦设置错误,会直接报错,导致任务启动失败,最直接的异常是 <strong>找不到程序的jar</strong></p>
<div class="language-bash codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-bash codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">flink run -m yarn-cluster -p 1 -c com.xx.Main job.jar</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>开发<code>Flink Sql</code>程序,也需要设置一系列环境参数,除此之外,如果要使用纯sql的方式开发,举一个最简单的例子,代码如下</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.table.api.EnvironmentSettings;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.table.api.Table;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.table.api.TableEnvironment;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class JavaTableApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        EnvironmentSettings bbSettings = EnvironmentSettings</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .newInstance()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .useBlinkPlanner()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        TableEnvironment bsTableEnv = TableEnvironment.create(bbSettings);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        String sourceDDL = &quot;CREATE TABLE datagen (  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; f_random INT,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; f_random_str STRING,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; ts AS localtimestamp,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; WATERMARK FOR ts AS ts  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot;) WITH (  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; &#x27;connector&#x27; = &#x27;datagen&#x27;,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; &#x27;rows-per-second&#x27;=&#x27;10&#x27;,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; &#x27;fields.f_random.min&#x27;=&#x27;1&#x27;,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; &#x27;fields.f_random.max&#x27;=&#x27;5&#x27;,  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; &#x27;fields.f_random_str.length&#x27;=&#x27;10&#x27;  &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot;)&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        bsTableEnv.executeSql(sourceDDL);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        String sinkDDL = &quot;CREATE TABLE print_table (&quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; f_random int,&quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; c_val bigint, &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot; wStart TIMESTAMP(3) &quot; +</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                &quot;) WITH (&#x27;connector&#x27; = &#x27;print&#x27;) &quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        bsTableEnv.executeSql(sinkDDL);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们会看到除了设置 <code>EnvironmentSettings</code> 参数之外,剩下的几乎大段大段的代码都是在写 <code>sql</code>,用java代码拼接各种sql,这种编码的方式,极不优雅,如果业务复杂,更是难以维护,而且会发现,整个编码的模式是统一的, 都是声明一段sql,然后调用 <code>executeSql</code> 方法</p>
<p><strong>我们的设想是</strong>:能不能以一种更好的方式将这种重复的工作简单化,将<code>DataStream</code>和<code>Flink Sql</code>任务中的一些环境初始化相关的参数和启动相关参数简化,最好一行代码都不写,针对<code>Flink Sql</code>作业,也不想在代码里写大段的sql,能不能以一种更优雅的方式解决?</p>
<p><strong>答案是肯定的</strong></p>
<p>针对参数设置的问题,在<code>StreamPark</code>中提出统一程序配置的概念,把程序的一系列参数从开发到部署阶段按照特定的格式配置到<code>application.yml</code>里,抽象出
一个通用的配置模板,按照这种规定的格式将上述配置的各项参数在配置文件里定义出来,在程序启动的时候将这个项目配置传入到程序中即可完成环境的初始化工作,在任务启动的时候也会自动识别启动时的参数.</p>
<p>针对Flink Sql作业在代码里写sql的问题,<code>StreamPark</code>针对<code>Flink Sql</code>作业做了更高层级封装和抽象,开发者只需要将sql按照一定的规范要求定义到<code>application.yaml</code>中,在程序启动时传入该文件到主程序中, 就会自动按照要求加载执行sql</p>
<p>下面我们来详细看看这个配置文件的各项配置都是如何进行配置的,有哪些注意事项</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-yaml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token key atrule">flink</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">target</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> yarn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">per</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">job</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">detached</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">shutdownOnAttachedExit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">zookeeperNamespace</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">jobmanager</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">property</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#@see: https://nightlies.apache.org/flink/flink-docs-release-1.15/docs/deployment/config/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">$internal.application.main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> org.apache.streampark.flink.quickstart.QuickStartApp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">pipeline.name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> streampark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">quickstartApp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">yarn.application.queue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">taskmanager.numberOfTaskSlots</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">parallelism.default</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">jobmanager.memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">flink.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">jvm-metaspace.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">jvm-overhead.max</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">off-heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">process.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">taskmanager.memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">flink.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">framework.heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">framework.off-heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">managed.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">process.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">task.heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">task.off-heap.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">jvm-metaspace.size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">jvm-overhead.max</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">jvm-overhead.min</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">managed.fraction</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">pipeline</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">auto-watermark-interval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 200ms</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># checkpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">execution</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">checkpointing</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">mode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> EXACTLY_ONCE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">interval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 30s</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">timeout</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 10min</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">unaligned</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">externalized-checkpoint-retention</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> RETAIN_ON_CANCELLATION</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># state backend</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">state</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">backend</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> hashmap </span><span class="token comment" style="color:rgb(106, 153, 85)"># Special note: flink1.12 optional configuration (&#x27;jobmanager&#x27;, &#x27;filesystem&#x27;, &#x27;rocksdb&#x27;), flink1.12+ optional configuration (&#x27;hashmap&#x27;, &#x27;rocksdb&#x27;),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">backend.incremental</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">checkpoint-storage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> filesystem</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">savepoints.dir</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">///tmp/chkdir</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">checkpoints.dir</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">///tmp/chkdir</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># restart strategy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">restart-strategy</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fixed</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">delay  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Restart strategy [(fixed-delay|failure-rate|none) a total of 3 configurable strategies]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">restart-strategy.fixed-delay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">attempts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">delay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">restart-strategy.failure-rate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">max-failures-per-interval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">failure-rate-interval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">delay</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">table</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">table.local-time-zone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> default </span><span class="token comment" style="color:rgb(106, 153, 85)"># @see https://nightlies.apache.org/flink/flink-docs-release-1.15/docs/dev/table/config/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># kafka source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">kafka.source</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">bootstrap.servers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> kfk1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">kfk3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">9092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> test_user</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">group.id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> user_01</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">auto.offset.reset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> earliest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># mysql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">jdbc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">driverClassName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> com.mysql.cj.jdbc.Driver</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">jdbcUrl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> jdbc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">3306/test</span><span class="token punctuation" style="color:rgb(212, 212, 212)">?</span><span class="token plain">useSSL=false</span><span class="token important">&amp;allowPublicKeyRetrieval=true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">sql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">flinksql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token scalar string" style="color:rgb(206, 145, 120)"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    CREATE TABLE datagen (</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_sequence INT,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_random INT,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_random_str STRING,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      ts AS localtimestamp,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      WATERMARK FOR ts AS ts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    ) WITH (</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;connector&#x27; = &#x27;datagen&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      -- optional options --</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;rows-per-second&#x27;=&#x27;5&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_sequence.kind&#x27;=&#x27;sequence&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_sequence.start&#x27;=&#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_sequence.end&#x27;=&#x27;1000&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_random.min&#x27;=&#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_random.max&#x27;=&#x27;1000000&#x27;,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;fields.f_random_str.length&#x27;=&#x27;10&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    CREATE TABLE print_table (</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_sequence INT,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_random INT,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      f_random_str STRING</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      ) WITH (</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">      &#x27;connector&#x27; = &#x27;print&#x27;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token scalar string" style="color:rgb(206, 145, 120)">    INSERT INTO print_table select f_sequence,f_random,f_random_str from datagen;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从全局看参数分为三大类: <code>flink</code>, <code>app</code>, <code>sql</code>, 各自作用如下:</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="flink">flink<a href="#flink" class="hash-link" aria-label="flink的直接链接" title="flink的直接链接">​</a></h3>
<p>flink下放的是作业的基础参数, 包括 <code>option</code> 和 <code>property</code>, <code>table</code> 三大类:</p>
<h4 class="anchor anchorWithStickyNavbar_myWT" id="option">option<a href="#option" class="hash-link" aria-label="option的直接链接" title="option的直接链接">​</a></h4>
<p><code>option</code>下放的参数是flink run 下支持的参数,目前支持的参数如下</p>
<div><table class="table-data" style="width:100%;display:inline-table"><thead><tr><td style="width:80px">短参数</td><td>完整参数(前缀&quot;--&quot;)</td><td style="width:60px">有效</td><td>取值范围值或类型</td><td>作用描述</td></tr></thead><tbody><tr><td>-t</td><td>target</td><td><span class="icon-times"></span></td><td> yarn-per-job | application </td><td>部署方式(目前只支持yarn-per-job,application)</td></tr><tr><td>-d</td><td>detached</td><td><span class="icon-times"></span></td><td>true | false</td><td>是否以detached模式启动</td></tr><tr><td>-n</td><td>allowNonRestoredState</td><td><span class="icon-times"></span></td><td>true | false</td><td>从savePoint恢复失败时是否允许跳过该步骤</td></tr><tr><td>-sae</td><td>shutdownOnAttachedExit</td><td><span class="icon-times"></span></td><td>true | false</td><td>attached模式下任务停止时是否关闭集群</td></tr><tr><td>-m</td><td>jobmanager</td><td><span class="icon-times"></span></td><td>yarn-cluster | 连接地址</td><td>JobManager的连接地址</td></tr><tr><td>-p</td><td>parallelism</td><td><span class="icon-check"></span></td><td>int</td><td>程序并行度</td></tr><tr><td>-c</td><td>class</td><td><span class="icon-check"></span></td><td>String</td><td>程序的main方法的全名称</td></tr></tbody></table></div>
<p><code>parallelism</code> (-p) 并行度不支持在option里配置,会在后面的property里配置
<code>class</code> (-c) 程序main不支持在option里配置,会在后面的property里配置</p>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">注意事项</div><p>option下的参数必须是 <code>完整参数名</code></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_myWT" id="property">property<a href="#property" class="hash-link" aria-label="property的直接链接" title="property的直接链接">​</a></h4>
<p><code>property</code>下放的参数是标准的flink参数(-D下的参数),flink所有的参数数据都可以在这里进行配置, 大致如下:</p>
<h5 class="anchor anchorWithStickyNavbar_myWT" id="基础参数">基础参数<a href="#基础参数" class="hash-link" aria-label="基础参数的直接链接" title="基础参数的直接链接">​</a></h5>
<p>基础参数可以配置的选项非常之多,这里举例5个最基础的设置</p>
<div><table class="table-data" style="width:100%;display:inline-table"><thead><tr><td>参数名称</td><td>作用描述</td><td>是否必须</td></tr></thead><tbody><tr><td><span class="label-info">$internal.application.main</span><i class="icon-copy"></i></td><td>程序的主类(main)的完整类名</td><td><span class="icon-toggle-on" title="必须"></span></td></tr><tr><td><span class="label-info">yarn.application.name</span><i class="icon-copy"></i></td><td>程序的名称(YARN中显示的任务名称)</td><td><span class="icon-toggle-on" title="必须"></span></td></tr><tr><td><span class="label-info">yarn.application.queue</span><i class="icon-copy"></i></td><td>在YARN中运行的队列名称</td><td><span class="icon-toggle-off" title="可选"></span></td></tr><tr><td><span class="label-info">taskmanager.numberOfTaskSlots</span><i class="icon-copy"></i></td><td>taskmanager Slot的数量</td><td><span class="icon-toggle-off" title="可选"></span></td></tr><tr><td><span class="label-info">parallelism.default</span><i class="icon-copy"></i></td><td>程序的并行</td><td><span class="icon-toggle-off" title="可选"></span></td></tr></tbody></table></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">注意事项</div><p><code>$internal.application.main</code> 和 <code>yarn.application.name</code> 这两个参数是必须的</p></div></div>
<p>如您需要设置更多的参数,可参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html" target="_blank" rel="noopener noreferrer"><code>这里</code></a>
一定要将这些参数放到<code>property</code>下,并且参数名称要正确,<code>StreamPark</code>会自动解析这些参数并生效</p>
<h5 class="anchor anchorWithStickyNavbar_myWT" id="memory参数">Memory参数<a href="#memory参数" class="hash-link" aria-label="Memory参数的直接链接" title="Memory参数的直接链接">​</a></h5>
<p>Memory相关的参数设置也非常之多,一般常见的配置如下</p>
<div><table class="table-data" style="width:100%;display:inline-table"><thead><tr><td style="width:380px">参数名称</td><td>作用描述</td></tr></thead><tbody><tr><td><span class="label-info">jobmanager.memory.heap.size</span><i class="icon-copy"></i></td><td>JobManager 的 JVM 堆内存</td></tr><tr><td><span class="label-info">jobmanager.memory.off-heap.size</span><i class="icon-copy"></i></td><td>JobManager 的堆外内存(直接内存或本地内存)</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-metaspace.size</span><i class="icon-copy"></i></td><td>Flink JVM进程的Metaspace</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-metaspace.size</span><i class="icon-copy"></i></td><td>Flink JVM进程的Metaspace</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-overhead.min</span><i class="icon-copy"></i></td><td>Flink JVM进程的Metaspace</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-metaspace.size</span><i class="icon-copy"></i></td><td>用于其  他 JVM 开销的本地内存</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-overhead.max</span><i class="icon-copy"></i></td><td>用于其他 JVM 开销的本地内存</td></tr><tr><td><span class="label-info">jobmanager.memory.jvm-overhead.fraction</span><i class="icon-copy"></i></td><td>用于其他 JVM开销的本地内存</td></tr><tr><td><span class="label-info">taskmanager.memory.framework.heap.size</span><i class="icon-copy"></i></td><td>用于Flink 框架的JVM堆内存(进阶配置)</td></tr><tr><td><span class="label-info">taskmanager.memory.task.heap.size</span><i class="icon-copy"></i></td><td>由Flink管理的用于排序,哈希表,缓存状态后端的本地内存</td></tr><tr><td><span class="label-info">taskmanager.memory.managed.size</span><i class="icon-copy"></i></td><td>用于其他 JVM 开销的本地内存</td></tr><tr><td><span class="label-info">taskmanager.memory.managed.fraction</span><i class="icon-copy"></i></td><td>用于其他 JVM 开销的本地内存</td></tr><tr><td><span class="label-info">taskmanager.memory.framework.off-heap.size</span><i class="icon-copy"></i></td><td>用于Flink框架的堆外内存(直接内存或本地内存)进阶配置</td></tr><tr><td><span class="label-info">taskmanager.memory.task.off-heap.size</span><i class="icon-copy"></i></td><td>用于Flink应用的算子及用户代码的堆外内存(直接内存或本地内存)</td></tr><tr><td><span class="label-info">taskmanager.memory.jvm-metaspace.size</span><i class="icon-copy"></i></td><td>Flink JVM 进程的 Metaspace</td></tr></tbody></table></div>
<p>同样,如你想配置更多的内存相关的参数,请参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html" target="_blank" rel="noopener noreferrer"><code>这里</code></a> 查看<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html" target="_blank" rel="noopener noreferrer"><code>Flink Process Memory</code></a> , <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_tm.html" target="_blank" rel="noopener noreferrer"><code>jobmanager</code></a> 及 <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_jobmanager.html" target="_blank" rel="noopener noreferrer"><code>taskmanager</code></a>
相关的内存配置将这些参数放到<code>property</code>下,保证参数正确即可生效</p>
<h5 class="anchor anchorWithStickyNavbar_myWT" id="配置总内存">配置总内存<a href="#配置总内存" class="hash-link" aria-label="配置总内存的直接链接" title="配置总内存的直接链接">​</a></h5>
<p>Flink JVM 进程的进程总内存（Total Process Memory）包含了由 Flink 应用使用的内存（Flink 总内存）以及由运行 Flink 的 JVM 使用的内存。 Flink 总内存（Total Flink Memory）包括 JVM 堆内存（Heap Memory）和堆外内存（Off-Heap Memory）。 其中堆外内存包括直接内存（Direct Memory）和本地内存（Native Memory）</p>
<center><img src="/doc/image/process_mem_model.svg" width="340px"></center>
<p>配置 Flink 进程内存最简单的方法是指定以下两个配置项中的任意一个：</p>
<div><table class="table-data" style="width:100%;display:inline-table"><thead><tr><td>配置项</td><td>TaskManager 配置参数</td><td>JobManager 配置参数</td></tr></thead><tbody><tr><td>Flink 总内存 </td><td><span class="label-info">taskmanager.memory.flink.size</span><i class="icon-copy"></i></td><td><span class="label-info">jobmanager.memory.flink.size</span><i class="icon-copy"></i></td></tr><tr><td>进程总内存</td><td><span class="label-info">taskmanager.memory.process.size</span><i class="icon-copy"></i></td><td><span class="label-info">jobmanager.memory.process.size</span><i class="icon-copy"></i></td></tr></tbody></table></div>
<div class="theme-admonition theme-admonition-danger alert alert--danger admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">注意事项</div><p>不建议同时设置进程总内存和 Flink 总内存。 这可能会造成内存配置冲突，从而导致部署失败。 额外配置其他内存部分时，同样需要注意可能产生的配置冲突。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="table">Table<a href="#table" class="hash-link" aria-label="Table的直接链接" title="Table的直接链接">​</a></h3>
<p>在<code>table</code>下是Flink Sql相关的配置,目前支持的配置项和作用如下</p>
<ul>
<li>planner</li>
<li>mode</li>
<li>catalog</li>
<li>database</li>
</ul>
<div><table class="table-data" style="width:100%;display:inline-table"><thead><tr><td>配置项</td><td>作用描述</td><td>参数值</td></tr></thead><tbody><tr><td><span class="label-info">planner</span><i class="icon-copy"></i></td><td>Table Planner</td><td>blink | old | any</td></tr><tr><td><span class="label-info">mode</span><i class="icon-copy"></i></td><td>Table Mode</td><td>streaming | batch</td></tr><tr><td><span class="label-info">catalog</span><i class="icon-copy"></i></td><td>指定catalog,如指定初始化时会使用到</td><td></td></tr><tr><td><span class="label-info">database</span><i class="icon-copy"></i></td><td>指定database,如指定初始化时会使用到</td><td></td></tr></tbody></table></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="app">app<a href="#app" class="hash-link" aria-label="app的直接链接" title="app的直接链接">​</a></h2>
<p>我们将作业中需要的一些用户自定义的 参数放到app下, 这里可以放用户需要的任意参数. 如,用户的需求是从kafka读取数据写入mysql, 则肯定会用到kafka和mysql的相关信息.
就可以定义到这里.</p>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="sql">sql<a href="#sql" class="hash-link" aria-label="sql的直接链接" title="sql的直接链接">​</a></h2>
<p>sql是在flink sql作业中需要指定的, 我们提倡将sql语句本身抽取到配置文件里,使开发更简单, 该sql得遵循yaml文件的定义规则,具体内部sql格式的定义非常简单,如下:</p>
<div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-sql codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">sql</span><span class="token plain">: </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> datagen </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_sequence </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_random </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_random_str STRING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> localtimestamp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    WATERMARK </span><span class="token keyword" style="color:rgb(86, 156, 214)">FOR</span><span class="token plain"> ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;datagen&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">-- optional options --</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;rows-per-second&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;5&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_sequence.kind&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sequence&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_sequence.start&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_sequence.end&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1000&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_random.min&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_random.max&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;1000&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;fields.f_random_str.length&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;10&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> print_table </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_sequence </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_random </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    f_random_str STRING</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;connector&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;print&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> print_table </span><span class="token keyword" style="color:rgb(86, 156, 214)">select</span><span class="token plain"> f_sequence</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">f_random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">f_random_str </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> datagen</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>sql</code>为当前sql的id,必须是唯一的,后面的内容则是具体的sql</p>
<div class="theme-admonition theme-admonition-danger alert alert--danger admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">特别注意</div><p>上面内容中 <strong>sql:</strong> 后面的 <strong>|</strong> 是必带的, 加上 <strong>|</strong> 会保留整段内容的格式,重点是保留了换行符, StreamPark封装了Flink Sql的提交,可以直接将多个Sql一次性定义出来,每个Sql必须用 <strong>;</strong> 分割,每段 Sql也必须遵循Flink Sql规定的格式和规范</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>本章节详细介绍了<code>配置文件</code>和<code>sql文件</code>的由来和具体配置,相信你已经有了一个初步的印象和概念,具体使用请查后续章节</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/i18n/zh-CN/docusaurus-plugin-content-docs/current/framework/2.conf.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_WHnd" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_YCJs"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev paginationNavLink_UdUv" href="/zh-CN/docs/framework/dev-model"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.2751 19.175L10.3251 18.125L5.4501 13.25H21.6001V11.75H5.4501L10.3251 6.87501L9.2751 5.82501L2.5751 12.5L9.2751 19.175Z" fill="currentColor"></path></svg><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">上一页</div><div class="paginationNavLabel_YPzM pagination-nav__label">编程模型</div></div></a><a class="pagination-nav__link pagination-nav__link--next paginationNavLink_UdUv" href="/zh-CN/docs/framework/quick-start"><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">下一页</div><div class="paginationNavLabel_YPzM pagination-nav__label">快速开始</div></div><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.7249 19.175L13.6749 18.125L18.5499 13.25H2.3999V11.75H18.5499L13.6749 6.87501L14.7249 5.82501L21.4249 12.5L14.7249 19.175Z" fill="currentColor"></path></svg></a></nav></div></div><div class="col col--3"><div class="docTOCContainer_nkwD theme-doc-toc-desktop-container"><div class="tableOfContents_jeP5 thin-scrollbar docTOC_GnpH theme-doc-toc-desktop" style="opacity:0;transform:translateX(100px) translateZ(0)"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#为什么需要配置" class="table-of-contents__link toc-highlight">为什么需要配置</a><ul><li><a href="#flink" class="table-of-contents__link toc-highlight">flink</a></li><li><a href="#table" class="table-of-contents__link toc-highlight">Table</a></li></ul></li><li><a href="#app" class="table-of-contents__link toc-highlight">app</a></li><li><a href="#sql" class="table-of-contents__link toc-highlight">sql</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">加入社区</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box btns">
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark"><i class="fa fa-github"></i><span>Github</span></a>
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark/issues"><i class="fa fa-slack"></i><span>Issue Tracking</span></a>
                  <a class="btn btn-primary" href="javascript:void(0)">
                    <i class="fa fa-wechat"></i>
                    <span>Wechat</span>
                    <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>
        <div>
          <div style="margin-bottom: 30px;">
            <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
              <img alt="Apache Incubator logo" class="footer__logo" width="200">
            </a>
          </div>
          <div>
            <p>
            Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </p>
          </div>
        </div>

        <div>
          <span>
            Copyright © 2022-2024 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
          </span>
        </div>
      </div></div></div></div></footer></div>
</body>
</html>