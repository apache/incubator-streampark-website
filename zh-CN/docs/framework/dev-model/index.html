<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-framework/dev-model" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">编程模型 | Apache StreamPark (incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://streampark.apache.org/zh-CN/docs/framework/dev-model"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="编程模型 | Apache StreamPark (incubating)"><meta data-rh="true" name="description" content="任何框架都有一些要遵循的规则和约定, 我们只有遵循并掌握了这些规则, 才能更加游刃有余的使用, 使其发挥事半功倍的效果, 我们开发 Flink 作业,其实就是利用 Flink 提供的 API , 按照 Flink 要求的开发方式, 写一个可以执行的(必须有main()函数)的程序, 在程序里接入各种Connector经过一系列的算子操作, 最终将数据通过Connector sink 到目标存储,"><meta data-rh="true" property="og:description" content="任何框架都有一些要遵循的规则和约定, 我们只有遵循并掌握了这些规则, 才能更加游刃有余的使用, 使其发挥事半功倍的效果, 我们开发 Flink 作业,其实就是利用 Flink 提供的 API , 按照 Flink 要求的开发方式, 写一个可以执行的(必须有main()函数)的程序, 在程序里接入各种Connector经过一系列的算子操作, 最终将数据通过Connector sink 到目标存储,"><link data-rh="true" rel="icon" href="/zh-CN/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://streampark.apache.org/zh-CN/docs/framework/dev-model"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/dev-model" hreflang="en"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/zh-CN/docs/framework/dev-model" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://streampark.apache.org/docs/framework/dev-model" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache StreamPark (incubating) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache StreamPark (incubating) Atom Feed"><link rel="stylesheet" href="/zh-CN/assets/css/styles.973b1f1a.css">
<script src="/zh-CN/assets/js/runtime~main.470707f1.js" defer="defer"></script>
<script src="/zh-CN/assets/js/main.ef599892.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_BCtO" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--light_uT2j"><img src="/zh-CN/image/logo.png" alt="StreamPark Logo" class="themedComponent_Cvhi themedComponent--dark_ENih"></div><b class="navbar__title text--truncate">StreamPark</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/get-started/intro">文档</a><a class="navbar__item navbar__link" href="/zh-CN/download">下载</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">社区</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">行为守则</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/mailing_lists">加入邮件列表</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_committer">成为 Committer</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/become_pmc_member">成为 PMC 成员</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_committer_process">新的 Committer 流程</a></li><li><a class="dropdown__link" href="/zh-CN/community/contribution_guide/new_pmc_ember_process">新的 PMC 成员流程</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/document">文档</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/submit_code">提交代码</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/code_style_and_quality_guide">代码风格和质量指南</a></li><li><a class="dropdown__link" href="/zh-CN/community/submit_guide/documentation_style_guide">文档书写规范</a></li><li><a class="dropdown__link" href="/zh-CN/community/release/how_to_release_version_2.1.x">How to release version 2.1.x</a></li><li><a class="dropdown__link" href="/zh-CN/community/release/how_to_verify_release">如何验证发版</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/team">团队</a><a class="navbar__item navbar__link" href="/zh-CN/user">用户</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">基金会</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">证书</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">事件</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">安全</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">致谢</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/blog">博客</a><a href="https://github.com/apache/incubator-streampark/issues/507" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><a href="https://github.com/apache/incubator-streampark" target="_blank" class="githubStars_qnS9"><div class="githubStarsContainer_O7dk"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.75C4.27062 1.75 1.25 4.77062 1.25 8.5C1.25 11.4869 3.18219 14.0097 5.86531 14.9041C6.20281 14.9631 6.32937 14.7606 6.32937 14.5834C6.32937 14.4231 6.32094 13.8916 6.32094 13.3263C4.625 13.6384 4.18625 12.9128 4.05125 12.5331C3.97531 12.3391 3.64625 11.74 3.35938 11.5797C3.12312 11.4531 2.78562 11.1409 3.35094 11.1325C3.8825 11.1241 4.26219 11.6219 4.38875 11.8244C4.99625 12.8453 5.96656 12.5584 6.35469 12.3813C6.41375 11.9425 6.59094 11.6472 6.785 11.4784C5.28312 11.3097 3.71375 10.7275 3.71375 8.14563C3.71375 7.41156 3.97531 6.80406 4.40563 6.33156C4.33812 6.16281 4.10187 5.47094 4.47312 4.54281C4.47312 4.54281 5.03844 4.36563 6.32937 5.23469C6.86937 5.08281 7.44313 5.00687 8.01688 5.00687C8.59063 5.00687 9.16438 5.08281 9.70438 5.23469C10.9953 4.35719 11.5606 4.54281 11.5606 4.54281C11.9319 5.47094 11.6956 6.16281 11.6281 6.33156C12.0584 6.80406 12.32 7.40312 12.32 8.14563C12.32 10.7359 10.7422 11.3097 9.24031 11.4784C9.485 11.6894 9.69594 12.0944 9.69594 12.7272C9.69594 13.63 9.6875 14.3556 9.6875 14.5834C9.6875 14.7606 9.81406 14.9716 10.1516 14.9041C12.8178 14.0097 14.75 11.4784 14.75 8.5C14.75 4.77062 11.7294 1.75 8 1.75Z" fill="currentColor"></path></svg><span class="githubText_YlX6">3.9k</span></div></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg></a><ul class="dropdown__menu"><li><a href="/docs/framework/dev-model" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-CN/docs/framework/dev-model" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">简体中文</a></li></ul></div><a class="colorModeButton_yITp undefined"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg></a><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_SuYZ"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_HgBb searchBarLoadingRing_om0w"><div></div><div></div><div></div><div></div></div></div></div><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_pmYA"><div class="docsWrapper_xNxE"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_yIRJ" type="button"></button><div class="docRoot_vmqG"><aside class="theme-doc-sidebar-container docSidebarContainer_hlm_"><div class="sidebarViewport_c8HV"><div class="sidebar_mhZE"><div class="sidebarSearchContainer_Lwc8"></div><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_Y1UP" style="padding-top:1.75rem;padding-bottom:250px;overflow-y:auto"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/get-started/intro">快速开始</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/platform/alert">平台使用手册</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/docs/framework/dev-model">开发框架</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/framework/dev-model">编程模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/framework/config">项目配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/framework/quick-start">快速开始</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/zh-CN/docs/framework/connector/kafka">连接器</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/development/development">开发者指南</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_Ke0w"><div class="container padding-top--md padding-bottom--lg"><div class="row" style="flex-wrap:nowrap"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_FXM1" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_vXXl"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">开发框架</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">编程模型</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>编程模型</h1></header><p>任何框架都有一些要遵循的规则和约定, 我们只有遵循并掌握了这些规则, 才能更加游刃有余的使用, 使其发挥事半功倍的效果, 我们开发 Flink 作业,其实就是利用 Flink 提供的 API , 按照 Flink 要求的开发方式, 写一个可以执行的(必须有<code>main()</code>函数)的程序, 在程序里接入各种<code>Connector</code>经过一系列的<code>算子</code>操作, 最终将数据通过<code>Connector</code> sink 到目标存储,
我们把这种按照某种约定的规则去逐步编程的方式称之为<code>编程模型</code>, 这一章节我们就来聊聊 StreamPark 的<code>编程模型</code>以及开发注意事项</p>
<p>我们从这几个方面开始入手</p>
<ul>
<li>架构</li>
<li>编程模型</li>
<li>RunTime Context</li>
<li>生命周期</li>
<li>目录结构</li>
<li>打包部署</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="架构">架构<a href="#架构" class="hash-link" aria-label="架构的直接链接" title="架构的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="/zh-CN/assets/images/streampark_archite-208af7dd55c924f7fd8e07280b3b89c4.png" width="2734" height="1311" class="img__KcZ"></p>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="编程模型">编程模型<a href="#编程模型" class="hash-link" aria-label="编程模型的直接链接" title="编程模型的直接链接">​</a></h2>
<p><code>streampark-core</code> 是快速开发框架,专门为简化 Flink 开发而生,开发者在开发阶段会使用到该模块,下面我们来看看 <code>DataStream</code> 和 <code>Flink Sql</code> 用 StreamPark 来开发编程模型是什么样的,有什么规范和要求</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="datastream">DataStream<a href="#datastream" class="hash-link" aria-label="DataStream的直接链接" title="DataStream的直接链接">​</a></h3>
<p>StreamPark 提供了 Scala 和 Java 两种 API 来开发 <code>DataStream</code> 程序，具体代码开发如下</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreaming</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.flink.api.scala._</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object MyFlinkApp extends FlinkStreaming {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class MyFlinkJavaApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamEnvConfig JavaConfig = new StreamEnvConfig(args, (environment, parameterTool) -&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            //用户可以给environment设置参数...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            System.out.println(&quot;environment argument set...&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamingContext context = new StreamingContext(JavaConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ....</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>用 <code>scala</code> API 开发,程序必须要继承 <code>FlinkStreaming</code> ,继承之后,会强制让开发者实现 <code>handle()</code> 方法,该方法就是用户写代码的入口, 同时 <code>streamingContext</code> 供开发者使用</p>
<p>用 <code>Java</code> API 开发由于语言本身的限制没法省掉 <code>main()</code> 方法,所以会是一个标准的 <code>main()</code> 函数, 需要用户手动创建 <code>StreamingContext</code>,<code>StreamingContext</code> 是非常重要的一个类,稍后会介绍</p>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">提示</div><p>以上几行 <code>scala</code> 和 <code>Java</code> 代码就是用 StreamPark 开发 <code>DataStream</code> 必不可少的最基本的骨架代码,用 StreamPark 开发 <code>DataStream</code> 程序,从这几行代码开始, Java API 开发需要开发者手动启动任务 <code>start</code></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="flink-sql">Flink Sql<a href="#flink-sql" class="hash-link" aria-label="Flink Sql的直接链接" title="Flink Sql的直接链接">​</a></h3>
<p>TableEnvironment 是用来创建 Table &amp; SQL 程序的上下文执行环境,也是 Table &amp; SQL 程序的入口,Table &amp; SQL 程序的所有功能都是围绕 TableEnvironment 这个核心类展开的。TableEnvironment 的主要职能包括：对接外部系统，表及元数据的注册和检索，执行 SQL 语句，提供更详细的配置选项。</p>
<p>Flink 社区一直在推进 DataStream 的批处理能力,统一流批一体,在 Flink 1.12 中流批一体真正统一运行,诸多历史 API 如: DataSet API, BatchTableEnvironment API 等被废弃,退出历史舞台,官方推荐使用 <strong>TableEnvironment</strong> 和 <strong>StreamTableEnvironment</strong></p>
<p>StreamPark 针对 <strong>TableEnvironment</strong> 和 <strong>StreamTableEnvironment</strong> 这两种环境的开发,提供了对应的更方便快捷的 API</p>
<h4 class="anchor anchorWithStickyNavbar_myWT" id="tableenvironment">TableEnvironment<a href="#tableenvironment" class="hash-link" aria-label="TableEnvironment的直接链接" title="TableEnvironment的直接链接">​</a></h4>
<p>开发Table &amp; SQL 作业, TableEnvironment 会是 Flink 推荐使用的入口类, 同时能支持 Java API 和 Scala API,下面的代码演示了在 StreamPark 如何开发一个 TableEnvironment 类型的作业</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkTable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object TableApp extends FlinkTable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.TableContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.TableEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class JavaTableApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        TableEnvConfig tableEnvConfig = new TableEnvConfig(args, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        TableContext context = new TableContext(tableEnvConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start(&quot;Flink SQl Job&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">提示</div><p>以上几行 Scala 和 Java 代码就是用 StreamPark 开发 TableEnvironment 必不可少的最基本的骨架代码,用 StreamPark 开发 TableEnvironment 程序,从这几行代码开始,
Scala API 必须继承 FlinkTable, Java API 开发需要手动构造 TableContext ,需要开发者手动启动任务 <code>start</code></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_myWT" id="streamtableenvironment">StreamTableEnvironment<a href="#streamtableenvironment" class="hash-link" aria-label="StreamTableEnvironment的直接链接" title="StreamTableEnvironment的直接链接">​</a></h4>
<p><code>StreamTableEnvironment</code> 用于流计算场景,流计算的对象是 <code>DataStream</code>。相比 <code>TableEnvironment</code>, <code>StreamTableEnvironment</code> 提供了 <code>DataStream</code> 和 <code>Table</code> 之间相互转换的接口,如果用户的程序除了使用 <code>Table API</code> &amp; <code>SQL</code> 编写外,还需要使用到 <code>DataStream API</code>,则需要使用 <code>StreamTableEnvironment</code>。
下面的代码演示了在 StreamPark 如何开发一个 <code>StreamTableEnvironment</code> 类型的作业</p>
<div class="tabs-container tabList_wCRy"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_v3ez tabs__item--active">Scala</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_v3ez">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Xevx"><div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">package org.apache.streampark.test.tablesql</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.FlinkStreamTable</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">object StreamTableApp extends FlinkStreamTable {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  override def handle(): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Xevx" hidden=""><div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.StreamTableContext;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">import org.apache.streampark.flink.core.scala.util.StreamTableEnvConfig;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public class JavaStreamTableApp {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamTableEnvConfig JavaConfig = new StreamTableEnvConfig(args, null, null);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        StreamTableContext context = new StreamTableContext(JavaConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        context.start(&quot;Flink SQl Job&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">特别注意</div><p>以上几行 scala 和 Java 代码就是用 StreamPark 开发 <code>StreamTableEnvironment</code> 必不可少的最基本的骨架代码,用 StreamPark 开发 <code>StreamTableEnvironment</code> 程序,从这几行代码开始,Java 代码需要手动构造 <code>StreamTableContext</code>,<code>Java API</code>开发需要开发者手动启动任务<code>start</code></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="runtime-context">RunTime Context<a href="#runtime-context" class="hash-link" aria-label="RunTime Context的直接链接" title="RunTime Context的直接链接">​</a></h2>
<p><strong>RunTime Context</strong> — <strong>StreamingContext</strong> , <strong>TableContext</strong> , <strong>StreamTableContext</strong> 是 StreamPark 中几个非常重要三个对象,接下来我们具体看看这三个 <strong>Context</strong> 的定义和作用</p>
<center><img src="/doc/image/streampark_coreapi.png" width="60%"></center>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="streamingcontext">StreamingContext<a href="#streamingcontext" class="hash-link" aria-label="StreamingContext的直接链接" title="StreamingContext的直接链接">​</a></h3>
<p><code>StreamingContext</code> 继承自 <code>StreamExecutionEnvironment</code>, 在 <code>StreamExecutionEnvironment</code> 的基础之上增加了 <code>ParameterTool</code> ,简单可以理解为:</p>
<p><strong>StreamingContext</strong> = <strong>ParameterTool</strong> + <strong>StreamExecutionEnvironment</strong></p>
<p>具体定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class StreamingContext(val parameter: ParameterTool, private val environment: StreamExecutionEnvironment)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    extends StreamExecutionEnvironment(environment.getJavaEnv) {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for scala</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: (ParameterTool, StreamExecutionEnvironment)) = this(args._1, args._2)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: StreamEnvConfig) = this(FlinkStreamingInitializer.initJavaStream(args))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip alert alert--success admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">特别注意</div><p>这个对象非常重要,在 <code>DataStream</code> 作业中会贯穿整个任务的生命周期, <code>StreamingContext</code> 本身继承自 <code>StreamExecutionEnvironment</code> ,配置文件会完全融合到 <code>StreamingContext</code> 中,这样就可以非常方便的从 <code>StreamingContext</code> 中获取各种参数</p></div></div>
<p>在 StreamPark 中, <code>StreamingContext</code> 也是 Java API 编写 <code>DataStream</code> 作业的入口类, <code>StreamingContext</code> 的构造方法中有一个是专门为 Java API 打造的,该构造函数定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> * for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def this(args: StreamEnvConfig) = this(FlinkStreamingInitializer.initJavaStream(args))</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由上面的构造方法可以看到创建 <code>StreamingContext</code>,需要传入一个 <code>StreamEnvConfig</code> 对象, <code>StreamEnvConfig</code> 定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class StreamEnvConfig(val args: Array[String], val conf: StreamEnvConfigFunction)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>StreamEnvConfig的构造方法中,其中</p>
<ul>
<li><code>args</code> 为启动参数,必须为 <code>main</code> 方法里的 <code>args</code></li>
<li><code>conf</code> 为 <code>StreamEnvConfigFunction</code> 类型的 <code>Function</code></li>
</ul>
<p><code>StreamEnvConfigFunction</code> 定义如下</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">@FunctionalInterface</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public interface StreamEnvConfigFunction {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * 用于初始化StreamExecutionEnvironment的时候,用于可以实现该函数,自定义要设置的参数...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * @param environment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * @param parameterTool</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    void configuration(StreamExecutionEnvironment environment, ParameterTool parameterTool);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该<code>Function</code>的作用是让开发者可以通过钩子的方式设置更多的参数,会将 <code>parameter</code> (解析配置文件里所有的参数)和初始化好的 <code>StreamExecutionEnvironment</code> 对象传给开发者去完成更多的参数设置,如:</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamEnvConfig JavaConfig = new StreamEnvConfig(args, (environment, parameterTool) -&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    System.out.println(&quot;environment argument set...&quot;);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    environment.getConfig().enableForceAvro();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">});</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamingContext context = new StreamingContext(JavaConfig);</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="tablecontext">TableContext<a href="#tablecontext" class="hash-link" aria-label="TableContext的直接链接" title="TableContext的直接链接">​</a></h3>
<p><code>TableContext</code> 继承自<code> TableEnvironment</code> ,在 <code>TableEnvironment</code> 的基础之上增加了 <code>ParameterTool</code> ,用来创建 <code>Table</code> &amp; <code>SQL</code> 程序的上下文执行环境,简单可以理解为:</p>
<p><strong>TableContext</strong> = <strong>ParameterTool</strong> + <strong>TableEnvironment</strong></p>
<p>具体定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class TableContext(val parameter: ParameterTool,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   private val tableEnv: TableEnvironment)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   extends TableEnvironment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   with FlinkTableTrait {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for scala</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: (ParameterTool, TableEnvironment)) = this(args._1, args._2)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: TableEnvConfig) = this(FlinkTableInitializer.initJavaTable(args))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在 StreamPark 中,<code>TableContext</code> 也是 Java API 编写 <code>TableEnvironment</code> 类型的 <code>Table Sql</code> 作业的入口类,<code>TableContext</code> 的构造方法中有一个是专门为 <code>Java API</code> 打造的,该构造函数定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">* for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">* @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def this(args: TableEnvConfig) = this(FlinkTableInitializer.initJavaTable(args))</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由上面的构造方法可以看到创建 <code>TableContext</code>,需要传入一个 <code>TableEnvConfig</code> 对象, <code>TableEnvConfig</code> 定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class TableEnvConfig(val args: Array[String], val conf: TableEnvConfigFunction)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>TableEnvConfig的构造方法中,其中</p>
<ul>
<li><code>args</code> 为启动参数,必须为 <code>main</code> 方法里的 <code>args</code></li>
<li><code>conf</code> 为 <code>TableEnvConfigFunction</code> 类型的 <code>Function</code></li>
</ul>
<p><code>TableEnvConfigFunction</code> 定义如下</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">@FunctionalInterface</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public interface TableEnvConfigFunction {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * 用于初始化TableEnvironment的时候,用于可以实现该函数,自定义要设置的参数...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * @param tableConfig</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     * @param parameterTool</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    void configuration(TableConfig tableConfig, ParameterTool parameterTool);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该 <code>Function</code> 的作用是让开发者可以通过钩子的方式设置更多的参数,会将 <code>parameter</code>(解析配置文件里所有的参数)和初始化好的 <code>TableEnvironment</code> 中的 <code>TableConfig</code> 对象传给开发者去完成更多的参数设置,如:</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">TableEnvConfig config = new TableEnvConfig(args,(tableConfig,parameterTool)-&gt;{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    tableConfig.setLocalTimeZone(ZoneId.of(&quot;Asia/Shanghai&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">});</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">TableContext context = new TableContext(config);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="streamtablecontext">StreamTableContext<a href="#streamtablecontext" class="hash-link" aria-label="StreamTableContext的直接链接" title="StreamTableContext的直接链接">​</a></h3>
<p><code>StreamTableContext</code> 继承自 <code>StreamTableEnvironment</code>,用于流计算场景,流计算的对象是 <code>DataStream</code>, 相比 <code>TableEnvironment</code>, <code>StreamTableEnvironment</code> 提供了 <code>DataStream</code> 和 <code>Table</code> 之间相互转换的接口,
<code>StreamTableContext</code> 在 <code>StreamTableEnvironment</code> 的基础之上增加了 <code>ParameterTool</code>,又直接接入了 <code>StreamTableEnvironment</code> 的API,简单可以理解为:</p>
<p><strong>StreamTableContext</strong> = <strong>ParameterTool</strong> + <strong>StreamTableEnvironment</strong> + <strong>StreamExecutionEnvironment</strong></p>
<p>具体定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">class StreamTableContext(val parameter: ParameterTool,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         private val streamEnv: StreamExecutionEnvironment,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         private val tableEnv: StreamTableEnvironment)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         extends StreamTableEnvironment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                         with FlinkTableTrait {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * 一旦 Table 被转化为 DataStream,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * 必须使用 StreamExecutionEnvironment 的 execute 方法执行该 DataStream 作业。</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private[scala] var isConvertedToDataStream: Boolean = false</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for scala</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: (ParameterTool, StreamExecutionEnvironment, StreamTableEnvironment)) =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  this(args._1, args._2, args._3)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def this(args: StreamTableEnvConfig) = this(FlinkTableInitializer.initJavaStreamTable(args))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在StreamPark中,<code>StreamTableContext</code> 是 Java API 编写 <code>StreamTableEnvironment</code> 类型的 <code>Table Sql</code> 作业的入口类,<code>StreamTableContext</code> 的构造方法中有一个是专门为 Java API 打造的,该构造函数定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * for Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * @param args</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">def this(args: StreamTableEnvConfig) = this(FlinkTableInitializer.initJavaStreamTable(args))</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由上面的构造方法可以看到创建 <code>StreamTableContext</code> ,需要传入一个 <code>StreamTableEnvConfig</code> 对象,<code>StreamTableEnvConfig</code> 定义如下:</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class StreamTableEnvConfig (</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val args: Array[String],</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val streamConfig: StreamEnvConfigFunction,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    val tableConfig: TableEnvConfigFunction</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>StreamTableEnvConfig 的构造方法中有三个参数,其中</p>
<ul>
<li><code>args</code> 为启动参数,必须为<code>main</code>方法里的<code>args</code></li>
<li><code>streamConfig</code> 为<code>StreamEnvConfigFunction</code>类型的<code>Function</code></li>
<li><code>tableConfig</code> 为<code>TableEnvConfigFunction</code>类型的<code>Function</code></li>
</ul>
<p><code>StreamEnvConfigFunction</code>和<code>TableEnvConfigFunction</code> 定义上面已经讲过,这里不再赘述</p>
<p>该<code>Function</code>的作用是让开发者可以通过钩子的方式设置更多的参数,和上面其他参数设置不同的是,该<code>Function</code>提供了同时设置<code>StreamExecutionEnvironment</code>和<code>TableEnvironment</code>的机会 ,会将 <code>parameter</code>和初始化好的<code>StreamExecutionEnvironment</code>和<code>TableEnvironment</code>中的<code>TableConfig</code>对象传给开发者去完成更多的参数设置,如:</p>
<div class="language-java codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-java codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamTableEnvConfig JavaConfig = new StreamTableEnvConfig(args, (environment, parameterTool) -&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    environment.getConfig().enableForceAvro();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}, (tableConfig, parameterTool) -&gt; {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    tableConfig.setLocalTimeZone(ZoneId.of(&quot;Asia/Shanghai&quot;));</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">});</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">StreamTableContext context = new StreamTableContext(JavaConfig);</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">特别提示</div><p>在 <code>StreamTableContext</code> 中可以直接使用 <code>StreamExecutionEnvironment</code> 的 <code>API</code>, <strong>以$打头的方法</strong> 都是 <code>StreamExecutionEnvironment</code> 的 API</p><p><img decoding="async" loading="lazy" src="/zh-CN/assets/images/streampark_apis-574b985bc649f26aacf875ccd0155793.jpeg" width="2024" height="1378" class="img__KcZ"></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="生命周期">生命周期<a href="#生命周期" class="hash-link" aria-label="生命周期的直接链接" title="生命周期的直接链接">​</a></h2>
<p>生命周期的概念目前只针对 <code>scala</code> API,该生命周期明确的定义了整个任务运行的全过程 ,但凡继承自 <code>FlinkStreaming</code> 或 <code>FlinkTable</code> 或 <code>StreamingTable</code> 就会按这个生命周期执行,生命周期的核心方法如下</p>
<div class="language-scala codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-scala codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"> final def main(args: Array[String]): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    init(args)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ready()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    handle()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    jobExecutionResult = context.start()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    destroy()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  private[this] def init(args: Array[String]): Unit = {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    SystemPropertyUtils.setAppHome(KEY_APP_HOME, classOf[FlinkStreaming])</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    context = new StreamingContext(FlinkStreamingInitializer.initStream(args, config))</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   * 用户可覆盖次方法...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def ready(): Unit = {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def config(env: StreamExecutionEnvironment, parameter: ParameterTool): Unit = {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def handle(): Unit</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  def destroy(): Unit = {}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生命周期如下</p>
<ul>
<li><strong>init</strong>          配置文件初始化阶段</li>
<li><strong>config</strong>        开发者手动设置参数阶段</li>
<li><strong>ready</strong>         启动之前执行自定义动作阶段</li>
<li><strong>handle</strong>        开发者代码接入阶段</li>
<li><strong>start</strong>         程序启动阶段</li>
<li><strong>destroy</strong>       销毁阶段</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Life Cycle" src="/zh-CN/assets/images/streampark_scala_life_cycle-7bfdf4f1228b36f59fae79943d5c8108.png" width="1790" height="1560" class="img__KcZ"></p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--init">生命周期之 — init<a href="#生命周期之--init" class="hash-link" aria-label="生命周期之 — init的直接链接" title="生命周期之 — init的直接链接">​</a></h3>
<p><strong>init</strong> 阶段,框架会自动解析传入的配置文件,按照里面的定义的各种参数初始化<code>StreamExecutionEnvironment</code>,这一步是框架自动执行,不需要开发者参与</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--config">生命周期之 — config<a href="#生命周期之--config" class="hash-link" aria-label="生命周期之 — config的直接链接" title="生命周期之 — config的直接链接">​</a></h3>
<p><strong>config</strong> 阶段的目的是让开发者可以通过钩子的方式设置更多的参数(约定的配置文件以外的其他参数),在 <strong>config</strong> 阶段会将 <code>parameter</code>(<em>init</em> 阶段解析的配置文件里所有的参数)和<em>init</em> 阶段初始化好的<code>StreamExecutionEnvironment</code>对象传给开发者,
这  样开发者就可以配置更多的参数</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">说明</div><p><strong>config</strong> 阶段是需要开发者参与的阶段,是可选的阶段</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--ready">生命周期之 — ready<a href="#生命周期之--ready" class="hash-link" aria-label="生命周期之 — ready的直接链接" title="生命周期之 — ready的直接链接">​</a></h3>
<p><strong>ready</strong> 阶段是在参数都设置完毕了,给开发者提供的一个用于做其他动作的入口, 该阶段是在<strong>初始化完成之后</strong>在<strong>程序启动之前</strong>进行</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">说明</div><p><strong>ready</strong> 阶段是需要开发者参与的阶段,是可选的阶段</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--handle">生命周期之 — handle<a href="#生命周期之--handle" class="hash-link" aria-label="生命周期之 — handle的直接链接" title="生命周期之 — handle的直接链接">​</a></h3>
<p><strong>handle</strong> 阶段是接入开发者编写的代码的阶段,是开发者编写代码的入口,也是最重要的一个阶段, 这个<code>handle</code> 方法会强制让开发者去实现</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">说明</div><p><strong>handle</strong> 阶段是需要开发者参与的阶段,是必须的阶段</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--start">生命周期之 — start<a href="#生命周期之--start" class="hash-link" aria-label="生命周期之 — start的直接链接" title="生命周期之 — start的直接链接">​</a></h3>
<p><strong>start</strong> 阶段,顾名思义,这个阶段会启动任务,由框架自动执行</p>
<h3 class="anchor anchorWithStickyNavbar_myWT" id="生命周期之--destroy">生命周期之 — destroy<a href="#生命周期之--destroy" class="hash-link" aria-label="生命周期之 — destroy的直接链接" title="生命周期之 — destroy的直接链接">​</a></h3>
<p><strong>destroy</strong> 阶段,是程序运行完毕了,在jvm退出之前的最后一个阶段,一般用于收尾的工作</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition"><div class="alert-icon admonition-icon"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div><div class="alert-content admonition-content"><div class="admonition-heading">说明</div><p><strong>destroy</strong> 阶段是需要开发者参与的阶段,是可选的阶段</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="目录结构">目录结构<a href="#目录结构" class="hash-link" aria-label="目录结构的直接链接" title="目录结构的直接链接">​</a></h2>
<p>推荐的项目目录结构如下,具体可以参考<a href="https://github.com/apache/incubator-streampark-quickstart" target="_blank" rel="noopener noreferrer">StreamPark Quickstart</a> 里的目录结构和配置</p>
<div class="language-tree codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-tree codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">|── assembly</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    ├── bin</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    ├── startup.sh                             //启动脚本</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    ├── setclasspath.sh                        //Java环境变量相关的脚本(框架内部使用,开发者无需关注)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    ├── shutdown.sh                            //任务停止脚本(不建议使用)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    └── flink.sh                               //启动时内部使用到的脚本(框架内部使用,开发者无需关注)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │── conf</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    ├── test</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    │    ├── application.yaml                  //测试(test)阶段的配置文件</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    │    └── sql.yaml                          //flink sql</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    ├── prod</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    │    ├── application.yaml                  //生产(prod)阶段的配置文件</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │    │    └── sql.yaml                          //flink sql</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    │── logs                                        //logs目录</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    └── temp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│── src</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│    └── main</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│         ├── Java</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│         ├── resources</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│         └── scala</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│── assembly.xml</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── pom.xml</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>assembly.xml 是assembly打包插件需要用到的配置文件,定义如下:</p>
<div class="language-xml codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-xml codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">assembly</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">id</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">bin</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">id</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">formats</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">format</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">tar.gz</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">format</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">formats</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSets</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">assembly/bin</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">bin</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">0755</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">${project.build.directory}</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">lib</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">0755</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">includes</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">include</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">*.jar</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">include</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">includes</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">excludes</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">exclude</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">original-*.jar</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">exclude</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">excludes</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">assembly/conf</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">conf</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">0755</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">assembly/logs</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">logs</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">0755</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">assembly/temp</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">directory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">temp</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">outputDirectory</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain">0755</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileMode</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSet</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">fileSets</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&lt;/</span><span class="token tag" style="color:rgb(78, 201, 176)">assembly</span><span class="token tag punctuation" style="color:rgb(212, 212, 212)">&gt;</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="打包部署">打包部署<a href="#打包部署" class="hash-link" aria-label="打包部署的直接链接" title="打包部署的直接链接">​</a></h2>
<p>推荐 <a href="https://github.com/apache/incubator-streampark-quickstart/tree/dev/quickstart-flink" target="_blank" rel="noopener noreferrer">streampark-flink-quickstart</a> 里的打包模式,直接运行<code>maven package</code>即可生成一个标准的StreamPark推荐的项目包,解包后目录结构如下</p>
<div class="language-text codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-text codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Streampark-flink-quickstart-1.0.0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── bin</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── startup.sh                             //启动脚本</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── setclasspath.sh                        //Java环境变量相关的脚本(内部使用的,用户无需关注)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── shutdown.sh                            //任务停止脚本(不建议使用)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── flink.sh                               //启动时内部使用到的脚本(内部使用的,用户无需关注)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── conf</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── application.yaml                       //项目的配置文件</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   ├── sql.yaml                               // flink sql文件</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├── lib</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   └── Streampark-flink-quickstart-1.0.0.jar     //项目的jar包</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└── temp</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_myWT" id="启动命令">启动命令<a href="#启动命令" class="hash-link" aria-label="启动命令的直接链接" title="启动命令的直接链接">​</a></h2>
<p>启动之前确定application.yaml和 sql.yaml 配置文件,如果要启动的任务是<code>DataStream</code>任务,直接在startup.sh后跟上配置文件即可</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-bash codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bin/startup.sh --conf conf/application.yaml</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果要启动的任务是<code>Flink Sql</code>任务,则需要跟上配置文件和sql.yaml</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_IhPH"><pre tabindex="0" class="prism-code language-bash codeBlock_tTXe thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_qImF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bin/startup.sh --conf conf/application.yaml --sql conf/sql.yaml</span><br></span></code></pre><div class="buttonGroup_inAn"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_N8Av" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EGLt"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_gJas"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/incubator-streampark-website/edit/dev/i18n/zh-CN/docusaurus-plugin-content-docs/current/framework/1.model.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_WHnd" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_YCJs"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev paginationNavLink_UdUv" href="/zh-CN/docs/platform/version-upgrade"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.2751 19.175L10.3251 18.125L5.4501 13.25H21.6001V11.75H5.4501L10.3251 6.87501L9.2751 5.82501L2.5751 12.5L9.2751 19.175Z" fill="currentColor"></path></svg><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">上一页</div><div class="paginationNavLabel_YPzM pagination-nav__label">版本升级指南</div></div></a><a class="pagination-nav__link pagination-nav__link--next paginationNavLink_UdUv" href="/zh-CN/docs/framework/config"><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">下一页</div><div class="paginationNavLabel_YPzM pagination-nav__label">项目配置</div></div><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.7249 19.175L13.6749 18.125L18.5499 13.25H2.3999V11.75H18.5499L13.6749 6.87501L14.7249 5.82501L21.4249 12.5L14.7249 19.175Z" fill="currentColor"></path></svg></a></nav></div></div><div class="col col--3"><div class="docTOCContainer_nkwD theme-doc-toc-desktop-container"><div class="tableOfContents_jeP5 thin-scrollbar docTOC_GnpH theme-doc-toc-desktop" style="opacity:0;transform:translateX(100px) translateZ(0)"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#架构" class="table-of-contents__link toc-highlight">架构</a></li><li><a href="#编程模型" class="table-of-contents__link toc-highlight">编程模型</a><ul><li><a href="#datastream" class="table-of-contents__link toc-highlight">DataStream</a></li><li><a href="#flink-sql" class="table-of-contents__link toc-highlight">Flink Sql</a></li></ul></li><li><a href="#runtime-context" class="table-of-contents__link toc-highlight">RunTime Context</a><ul><li><a href="#streamingcontext" class="table-of-contents__link toc-highlight">StreamingContext</a></li><li><a href="#tablecontext" class="table-of-contents__link toc-highlight">TableContext</a></li><li><a href="#streamtablecontext" class="table-of-contents__link toc-highlight">StreamTableContext</a></li></ul></li><li><a href="#生命周期" class="table-of-contents__link toc-highlight">生命周期</a><ul><li><a href="#生命周期之--init" class="table-of-contents__link toc-highlight">生命周期之 — init</a></li><li><a href="#生命周期之--config" class="table-of-contents__link toc-highlight">生命周期之 — config</a></li><li><a href="#生命周期之--ready" class="table-of-contents__link toc-highlight">生命周期之 — ready</a></li><li><a href="#生命周期之--handle" class="table-of-contents__link toc-highlight">生命周期之 — handle</a></li><li><a href="#生命周期之--start" class="table-of-contents__link toc-highlight">生命周期之 — start</a></li><li><a href="#生命周期之--destroy" class="table-of-contents__link toc-highlight">生命周期之 — destroy</a></li></ul></li><li><a href="#目录结构" class="table-of-contents__link toc-highlight">目录结构</a></li><li><a href="#打包部署" class="table-of-contents__link toc-highlight">打包部署</a></li><li><a href="#启动命令" class="table-of-contents__link toc-highlight">启动命令</a></li></ul></div></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">加入社区</div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="subscribe-box btns">
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark"><i class="fa fa-github"></i><span>Github</span></a>
                  <a class="btn btn-primary" href="https://github.com/apache/incubator-streampark/issues"><i class="fa fa-slack"></i><span>Issue Tracking</span></a>
                  <a class="btn btn-primary" href="javascript:void(0)">
                    <i class="fa fa-wechat"></i>
                    <span>Wechat</span>
                    <div class="wechat-dropdown"><img src="/image/join_wechat.png" alt="weChat"></div>
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div>
        <div>
          <div style="margin-bottom: 30px;">
            <a href="https://incubator.apache.org/" class="footerLogoLink" one-link-mark="yes">
              <img alt="Apache Incubator logo" class="footer__logo" width="200">
            </a>
          </div>
          <div>
            <p>
            Apache StreamPark is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </p>
          </div>
        </div>

        <div>
          <span>
            Copyright © 2022-2024 The Apache Software Foundation. Apache StreamPark, StreamPark, and its feather logo are trademarks of The Apache Software Foundation.
          </span>
        </div>
      </div></div></div></div></footer></div>
</body>
</html>